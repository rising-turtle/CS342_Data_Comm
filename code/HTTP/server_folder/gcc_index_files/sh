(function(){function ui(n){return n.call.apply(n.bind,arguments)}function fi(n,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(t,r)}}return function(){return n.apply(t,arguments)}}function i(){return i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ui:fi,i.apply(null,arguments)}function ei(n,t){this.a=n;this.m=t||n;this.c=this.m.document}function p(n,t,i,r){if(t=n.c.createElement(t),i)for(var u in i)i.hasOwnProperty(u)&&("style"==u?t.style.cssText=i[u]:t.setAttribute(u,i[u]));return r&&t.appendChild(n.c.createTextNode(r)),t}function g(n,t,i){n=n.c.getElementsByTagName(t)[0];n||(n=document.documentElement);n.insertBefore(i,n.lastChild)}function s(n){n.parentNode&&n.parentNode.removeChild(n)}function u(n,t,i){var f,r,e,u;for(t=t||[],i=i||[],f=n.className.split(/\s+/),r=0;r<t.length;r+=1){for(e=!1,u=0;u<f.length;u+=1)if(t[r]===f[u]){e=!0;break}e||f.push(t[r])}for(t=[],r=0;r<f.length;r+=1){for(e=!1,u=0;u<i.length;u+=1)if(f[r]===i[u]){e=!0;break}e||t.push(f[r])}n.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function nt(n,t){for(var r=n.className.split(/\s+/),i=0,u=r.length;i<u;i++)if(r[i]==t)return!0;return!1}function w(n){if("string"==typeof n.f)return n.f;var t=n.m.location.protocol;return"about:"==t&&(t=n.a.location.protocol),"https:"==t?"https:":"https:"}function si(n){return n.m.location.hostname||n.a.location.hostname}function tt(n,t,i){function u(){f&&r&&o&&(f(e),f=null)}t=p(n,"link",{rel:"stylesheet",href:t,media:"all"});var r=!1,o=!0,e=null,f=i||null;oi?(t.onload=function(){r=!0;u()},t.onerror=function(){r=!0;e=Error("Stylesheet failed to load");u()}):setTimeout(function(){r=!0;u()},0);g(n,"head",t)}function b(n,t,i,r){var e=n.c.getElementsByTagName("head")[0],u,f;return e?(u=p(n,"script",{src:t}),f=!1,u.onload=u.onreadystatechange=function(){f||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(f=!0,i&&i(null),u.onload=u.onreadystatechange=null,"HEAD"==u.parentNode.tagName&&e.removeChild(u))},e.appendChild(u),setTimeout(function(){f||(f=!0,i&&i(Error("Script load timeout")))},r||5e3),u):null}function it(){this.a=0;this.c=null}function rt(n){return n.a++,function(){n.a--;ft(n)}}function ut(n,t){n.c=t;ft(n)}function ft(n){0==n.a&&n.c&&(n.c(),n.c=null)}function et(n){this.a=n||"-"}function t(n,t){this.c=n;this.f=4;this.a="n";var i=(t||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function hi(n){return st(n)+" "+(n.f+"00")+" 300px "+ot(n.c)}function ot(n){var r=[],i,t;for(n=n.split(/,\s*/),i=0;i<n.length;i++)t=n[i].replace(/['"]/g,""),-1!=t.indexOf(" ")||/^\d/.test(t)?r.push("'"+t+"'"):r.push(t);return r.join(",")}function n(n){return n.a+n.f}function st(n){var t="normal";return"o"===n.a?t="oblique":"i"===n.a&&(t="italic"),t}function ci(n){var i=4,r="n",t=null;return n&&((t=n.match(/(normal|oblique|italic)/i))&&t[1]&&(r=t[1].substr(0,1).toLowerCase()),(t=n.match(/([1-9]00|normal|bold)/i))&&t[1]&&(/bold/i.test(t[1])?i=7:/[1-9]00/.test(t[1])&&(i=parseInt(t[1].substr(0,1),10)))),r+i}function li(n,t){this.c=n;this.f=n.m.document.documentElement;this.h=t;this.a=new et("-");this.j=!1!==t.events;this.g=!1!==t.classes}function ai(n){n.g&&u(n.f,[n.a.c("wf","loading")]);f(n,"loading")}function ht(n){if(n.g){var i=nt(n.f,n.a.c("wf","active")),t=[],r=[n.a.c("wf","loading")];i||t.push(n.a.c("wf","inactive"));u(n.f,t,r)}f(n,"inactive")}function f(t,i,r){t.j&&t.h[i]&&(r?t.h[i](r.c,n(r)):t.h[i]())}function vi(){this.c={}}function yi(n,t,i){var f=[],r,u;for(r in t)t.hasOwnProperty(r)&&(u=n.c[r],u&&f.push(u(t[r],i)));return f}function h(n,t){this.c=n;this.f=t;this.a=p(this.c,"span",{"aria-hidden":"true"},this.f)}function c(n){g(n.c,"body",n.a)}function l(n){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+ot(n.c)+";"+("font-style:"+st(n)+";font-weight:"+(n.f+"00")+";")}function ct(n,t,i,r,u,f){this.g=n;this.j=t;this.a=r;this.c=i;this.f=u||3e3;this.h=f||void 0}function lt(i,r,u,f,e,o,s){this.v=i;this.B=r;this.c=u;this.a=f;this.s=s||"BESbswy";this.f={};this.w=e||3e3;this.u=o||null;this.o=this.j=this.h=this.g=null;this.g=new h(this.c,this.s);this.h=new h(this.c,this.s);this.j=new h(this.c,this.s);this.o=new h(this.c,this.s);i=new t(this.a.c+",serif",n(this.a));i=l(i);this.g.a.style.cssText=i;i=new t(this.a.c+",sans-serif",n(this.a));i=l(i);this.h.a.style.cssText=i;i=new t("serif",n(this.a));i=l(i);this.j.a.style.cssText=i;i=new t("sans-serif",n(this.a));i=l(i);this.o.a.style.cssText=i;c(this.g);c(this.h);c(this.j);c(this.o)}function at(){if(null===a){var n=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);a=!!n&&(536>parseInt(n[1],10)||536===parseInt(n[1],10)&&11>=parseInt(n[2],10))}return a}function vt(n,t,i){for(var r in e)if(e.hasOwnProperty(r)&&t===n.f[e[r]]&&i===n.f[e[r]])return!0;return!1}function yt(n){var t=n.g.a.offsetWidth,i=n.h.a.offsetWidth,r;(r=t===n.f.serif&&i===n.f["sans-serif"])||(r=at()&&vt(n,t,i));r?o()-n.A>=n.w?at()&&vt(n,t,i)&&(null===n.u||n.u.hasOwnProperty(n.a.c))?k(n,n.v):k(n,n.B):pi(n):k(n,n.v)}function pi(n){setTimeout(i(function(){yt(this)},n),50)}function k(n,t){setTimeout(i(function(){s(this.g.a);s(this.h.a);s(this.j.a);s(this.o.a);t(this.a)},n),0)}function d(n,t,i){this.c=n;this.a=t;this.f=0;this.o=this.j=!1;this.s=i}function pt(n){0==--n.f&&n.j&&(n.o?(n=n.a,n.g&&u(n.f,[n.a.c("wf","active")],[n.a.c("wf","loading"),n.a.c("wf","inactive")]),f(n,"active")):ht(n.a))}function wt(n){this.j=n;this.a=new vi;this.h=0;this.f=this.g=!0}function wi(t,r,e,o,s){var h=0==--t.h;(t.f||t.g)&&setTimeout(function(){var w=s||null,b=o||null||{},t,a;if(0===e.length&&h)ht(r.a);else{for(r.f+=e.length,h&&(r.j=h),a=[],t=0;t<e.length;t++){var y=e[t],p=b[y.c],c=r.a,l=y;c.g&&u(c.f,[c.a.c("wf",l.c,n(l).toString(),"loading")]);f(c,"fontloading",l);c=null;null===v&&(v=window.FontFace?(l=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent))?42<parseInt(l[1],10):!0:!1);c=v?new ct(i(r.g,r),i(r.h,r),r.c,y,r.s,p):new lt(i(r.g,r),i(r.h,r),r.c,y,r.s,w,p);a.push(c)}for(t=0;t<a.length;t++)a[t].start()}},0)}function bi(n,t,i){var r=[],f=i.timeout,u;for(ai(t),r=yi(n.a,i,n.c),u=new d(n.c,t,f),n.h=r.length,t=0,i=r.length;t<i;t++)r[t].load(function(t,i,r){wi(n,u,t,i,r)})}function bt(n,t){this.c=n;this.a=t}function ki(n,t,i){var r=w(n.c);return n=(n.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,""),r+"//"+n+"/"+t+".js"+(i?"?v="+i:"")}function kt(n,t){this.c=n;this.a=t}function di(n,t,i){this.c=n?n:t+dt;this.a=[];this.f=[];this.g=i||""}function gi(n,t){for(var i,u,f=t.length,r=0;r<f;r++)i=t[r].split(":"),3==i.length&&n.f.push(i.pop()),u="",2==i.length&&""!=i[1]&&(u=":"),n.a.push(i.join(u))}function nr(n){if(0==n.a.length)throw Error("No fonts to load!");if(-1!=n.c.indexOf("kit="))return n.c;for(var t=n.a.length,r=[],i=0;i<t;i++)r.push(n.a[i].replace(/ /g,"+"));return t=n.c+"?family="+r.join("%7C"),0<n.f.length&&(t+="&subset="+n.f.join(",")),0<n.g.length&&(t+="&text="+encodeURIComponent(n.g)),t}function tr(n){this.f=n;this.a=[];this.c={}}function fr(n){for(var f,o,r,l,u,a=n.f.length,s=0;s<a;s++){var i=n.f[s].split(":"),e=i[0].replace(/\+/g," "),h=["n4"];if(2<=i.length){if(o=i[1],f=[],o)for(var o=o.split(","),v=o.length,c=0;c<v;c++)r=o[c],r.match(/^[\w-]+$/)?(u=ur.exec(r.toLowerCase()),null==u?r="":(r=u[2],r=null==r||""==r?"n":rr[r],u=u[1],null==u||""==u?u="4":(l=ir[u],u=l?l:isNaN(u)?"4":u.substr(0,1)),r=[r,u].join(""))):r="",r&&f.push(r);0<f.length&&(h=f);3==i.length&&(i=i[2],f=[],i=i?i.split(","):f,0<i.length&&(i=gt[i[0]])&&(n.c[e]=i))}for(n.c[e]||(i=gt[e])&&(n.c[e]=i),i=0;i<h.length;i+=1)n.a.push(new t(e,h[i]))}}function ni(n,t){this.c=n;this.a=t}function ii(n,t){this.c=n;this.a=t}function ri(n,t){this.c=n;this.f=t;this.a=[]}var o=Date.now||function(){return+new Date},oi=!!window.FontFace,e,a,v,dt,ti,r,y;et.prototype.c=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)};ct.prototype.start=function(){var t=this.c.m.document,n=this,i=o(),r=new Promise(function(r,u){function f(){o()-i>=n.f?u():t.fonts.load(hi(n.a),n.h).then(function(n){1<=n.length?r():setTimeout(f,25)},function(){u()})}f()}),u=new Promise(function(t,i){setTimeout(i,n.f)});Promise.race([u,r]).then(function(){n.g(n.a)},function(){n.j(n.a)})};e={D:"serif",C:"sans-serif"};a=null;lt.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f["sans-serif"]=this.o.a.offsetWidth;this.A=o();yt(this)};v=null;d.prototype.g=function(t){var i=this.a;i.g&&u(i.f,[i.a.c("wf",t.c,n(t).toString(),"active")],[i.a.c("wf",t.c,n(t).toString(),"loading"),i.a.c("wf",t.c,n(t).toString(),"inactive")]);f(i,"fontactive",t);this.o=!0;pt(this)};d.prototype.h=function(t){var i=this.a;if(i.g){var e=nt(i.f,i.a.c("wf",t.c,n(t).toString(),"active")),r=[],o=[i.a.c("wf",t.c,n(t).toString(),"loading")];e||r.push(i.a.c("wf",t.c,n(t).toString(),"inactive"));u(i.f,r,o)}f(i,"fontinactive",t);pt(this)};wt.prototype.load=function(n){this.c=new ei(this.j,n.context||this.j);this.g=!1!==n.events;this.f=!1!==n.classes;bi(this,new li(this.c,n),n)};bt.prototype.load=function(n){function f(){var r,o,h,e,s;if(u["__mti_fntLst"+i]){if(r=u["__mti_fntLst"+i](),o=[],r)for(e=0;e<r.length;e++)s=r[e].fontfamily,void 0!=r[e].fontStyle&&void 0!=r[e].fontWeight?(h=r[e].fontStyle+r[e].fontWeight,o.push(new t(s,h))):o.push(new t(s));n(o)}else setTimeout(function(){f()},50)}var r=this,i=r.a.projectId,e=r.a.version,u;i?(u=r.c.m,b(this.c,ki(r,i,e),function(t){t?n([]):(u["__MonotypeConfiguration__"+i]=function(){return r.a},f())}).id="__MonotypeAPIScript__"+i):n([])};kt.prototype.load=function(n){for(var r=this.a.urls||[],s=this.a.families||[],c=this.a.testStrings||{},h=new it,f,o,e,i=0,u=r.length;i<u;i++)tt(this.c,r[i],rt(h));for(f=[],i=0,u=s.length;i<u;i++)if(r=s[i].split(":"),r[1])for(o=r[1].split(","),e=0;e<o.length;e+=1)f.push(new t(r[0],o[e]));else f.push(new t(r[0]));ut(h,function(){n(f,c)})};dt="//fonts.googleapis.com/css";var gt={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},ir={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},rr={i:"i",italic:"i",n:"n",normal:"n"},ur=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;ti={Arimo:!0,Cousine:!0,Tinos:!0};ni.prototype.load=function(n){var i=new it,r=this.c,u=new di(this.a.api,w(r),this.a.text),f=this.a.families,t;gi(u,f);t=new tr(f);fr(t);tt(r,nr(u),rt(i));ut(i,function(){n(t.a,t.c,ti)})};ii.prototype.load=function(n){var r=this.a.id,i=this.c.m;r?b(this.c,(this.a.api||"https://use.typekit.net")+"/"+r+".js",function(r){var f,u;if(r)n([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){for(r=i.Typekit.config.fn,f=[],u=0;u<r.length;u+=2)for(var s=r[u],o=r[u+1],e=0;e<o.length;e++)f.push(new t(s,o[e]));try{i.Typekit.load({events:!1,classes:!1,"async":!0})}catch(h){}n(f)}},2e3):n([])};ri.prototype.load=function(n){var i=this.f.id,r=this.c.m,u=this;i?(r.__webfontfontdeckmodule__||(r.__webfontfontdeckmodule__={}),r.__webfontfontdeckmodule__[i]=function(i,r){for(var e,f=0,o=r.fonts.length;f<o;++f)e=r.fonts[f],u.a.push(new t(e.name,ci("font-weight:"+e.weight+";font-style:"+e.style)));n(u.a)},b(this.c,w(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+si(this.c)+"/"+i+".js",function(t){t&&n([])})):n([])};r=new wt(window);r.a.c.custom=function(n,t){return new kt(t,n)};r.a.c.fontdeck=function(n,t){return new ri(t,n)};r.a.c.monotype=function(n,t){return new bt(t,n)};r.a.c.typekit=function(n,t){return new ii(t,n)};r.a.c.google=function(n,t){return new ni(t,n)};y={load:i(r.load,r)};"function"==typeof define&&define.amd?define(function(){return y}):"undefined"!=typeof module&&module.exports?module.exports=y:(window.ShWebFont=y,window.ShWebFontConfig&&r.load(window.ShWebFontConfig))})();
/*! Browser bundle of nunjucks 3.2.0 (slim, only works with precompiled templates) */
!function (t, n) { t.shNunjucks = n(); }("undefined" != typeof self ? self : this, function () { return function (t) { var n = {}; function r(i) { if (n[i]) return n[i].exports; var e = n[i] = { i: i, l: !1, exports: {} }; return t[i].call(e.exports, e, e.exports, r), e.l = !0, e.exports } return r.m = t, r.c = n, r.d = function (t, n, i) { r.o(t, n) || Object.defineProperty(t, n, { configurable: !1, enumerable: !0, get: i }) }, r.n = function (t) { var n = t && t.__esModule ? function () { return t.default } : function () { return t }; return r.d(n, "a", n), n }, r.o = function (t, n) { return Object.prototype.hasOwnProperty.call(t, n) }, r.p = "", r(r.s = 6) }([function (t, n) { }, function (t, n, r) { "use strict"; var i = Array.prototype, e = Object.prototype, u = { "&": "&amp;", '"': "&quot;", "'": "&#39;", "<": "&lt;", ">": "&gt;" }, o = /[&"'<>]/g; function f(t, n) { return e.hasOwnProperty.call(t, n) } function c(t) { return u[t] } function s(t, n, r) { var i, e, u; if (t instanceof Error && (t = (e = t).name + ": " + e.message), Object.setPrototypeOf ? Object.setPrototypeOf(i = Error(t), s.prototype) : Object.defineProperty(i = this, "message", { enumerable: !1, writable: !0, value: t }), Object.defineProperty(i, "name", { value: "Template render error" }), Error.captureStackTrace && Error.captureStackTrace(i, this.constructor), e) { var o = Object.getOwnPropertyDescriptor(e, "stack"); (u = o && (o.get || function () { return o.value })) || (u = function () { return e.stack }) } else { var f = Error(t).stack; u = function () { return f } } return Object.defineProperty(i, "stack", { get: function () { return u.call(i) } }), Object.defineProperty(i, "cause", { value: e }), i.lineno = n, i.colno = r, i.firstUpdate = !0, i.Update = function (t) { var n = "(" + (t || "unknown path") + ")"; return this.firstUpdate && (this.lineno && this.colno ? n += " [Line " + this.lineno + ", Column " + this.colno + "]" : this.lineno && (n += " [Line " + this.lineno + "]")), n += "\n ", this.firstUpdate && (n += " "), this.message = n + (this.message || ""), this.firstUpdate = !1, this }, i } function a(t) { return "[object Function]" === e.toString.call(t) } function h(t) { return "[object Array]" === e.toString.call(t) } function v(t) { return "[object String]" === e.toString.call(t) } function l(t) { return "[object Object]" === e.toString.call(t) } function d(t) { return Array.prototype.slice.call(t) } function p(t, n, r) { return Array.prototype.indexOf.call(t || [], n, r) } function y(t) { var n = []; for (var r in t) f(t, r) && n.push(r); return n } (n = t.exports = {}).hasOwnProp = f, n.t = function (t, r, i) { if (i.Update || (i = new n.TemplateError(i)), i.Update(t), !r) { var e = i; (i = Error(e.message)).name = e.name } return i }, Object.setPrototypeOf ? Object.setPrototypeOf(s.prototype, Error.prototype) : s.prototype = Object.create(Error.prototype, { constructor: { value: s } }), n.TemplateError = s, n.escape = function (t) { return t.replace(o, c) }, n.isFunction = a, n.isArray = h, n.isString = v, n.isObject = l, n.groupBy = function (t, n) { for (var r = {}, i = a(n) ? n : function (t) { return t[n] }, e = 0; e < t.length; e++) { var u = t[e], o = i(u, e); (r[o] || (r[o] = [])).push(u) } return r }, n.toArray = d, n.without = function (t) { var n = []; if (!t) return n; for (var r = t.length, i = d(arguments).slice(1), e = -1; ++e < r;)-1 === p(i, t[e]) && n.push(t[e]); return n }, n.repeat = function (t, n) { for (var r = "", i = 0; i < n; i++)r += t; return r }, n.each = function (t, n, r) { if (null != t) if (i.forEach && t.forEach === i.forEach) t.forEach(n, r); else if (t.length === +t.length) for (var e = 0, u = t.length; e < u; e++)n.call(r, t[e], e, t) }, n.map = function (t, n) { var r = []; if (null == t) return r; if (i.map && t.map === i.map) return t.map(n); for (var e = 0; e < t.length; e++)r[r.length] = n(t[e], e); return t.length === +t.length && (r.length = t.length), r }, n.asyncIter = function (t, n, r) { var i = -1; !function e() { ++i < t.length ? n(t[i], i, e, r) : r() }() }, n.asyncFor = function (t, n, r) { var i = y(t || {}), e = i.length, u = -1; !function o() { var f = i[++u]; u < e ? n(f, t[f], u, e, o) : r() }() }, n.indexOf = p, n.keys = y, n.r = function (t) { return y(t).map(function (n) { return [n, t[n]] }) }, n.u = function (t) { return y(t).map(function (n) { return t[n] }) }, n.f = n.extend = function (t, n) { return t = t || {}, y(n).forEach(function (r) { t[r] = n[r] }), t }, n.inOperator = function (t, n) { if (h(n) || v(n)) return -1 !== n.indexOf(t); if (l(n)) return t in n; throw Error('Cannot use "in" operator to search for "' + t + '" in unexpected types.') } }, function (t, n, r) { "use strict"; var i = r(1), e = Array.from, u = "function" == typeof Symbol && Symbol.iterator && "function" == typeof e, o = function () { function t(t, n) { this.variables = {}, this.parent = t, this.topLevel = !1, this.isolateWrites = n } var n = t.prototype; return n.set = function (t, n, r) { var i = t.split("."), e = this.variables, u = this; if (r && (u = this.resolve(i[0], !0))) u.set(t, n); else { for (var o = 0; o < i.length - 1; o++) { var f = i[o]; e[f] || (e[f] = {}), e = e[f] } e[i[i.length - 1]] = n } }, n.get = function (t) { var n = this.variables[t]; return void 0 !== n ? n : null }, n.lookup = function (t) { var n = this.parent, r = this.variables[t]; return void 0 !== r ? r : n && n.lookup(t) }, n.resolve = function (t, n) { var r = n && this.isolateWrites ? void 0 : this.parent; return void 0 !== this.variables[t] ? this : r && r.resolve(t) }, n.push = function (n) { return new t(this, n) }, n.pop = function () { return this.parent }, t }(); function f(t) { return t && Object.prototype.hasOwnProperty.call(t, "__keywords") } function c(t) { var n = t.length; return 0 === n ? 0 : f(t[n - 1]) ? n - 1 : n } function s(t) { if ("string" != typeof t) return t; this.val = t, this.length = t.length } s.prototype = Object.create(String.prototype, { length: { writable: !0, configurable: !0, value: 0 } }), s.prototype.valueOf = function () { return this.val }, s.prototype.toString = function () { return this.val }, t.exports = { Frame: o, makeMacro: function (t, n, r) { var i = this; return function () { for (var e = arguments.length, u = Array(e), o = 0; o < e; o++)u[o] = arguments[o]; var s, a = c(u), h = function (t) { var n = t.length; if (n) { var r = t[n - 1]; if (f(r)) return r } return {} }(u); if (a > t.length) s = u.slice(0, t.length), u.slice(s.length, a).forEach(function (t, r) { r < n.length && (h[n[r]] = t) }), s.push(h); else if (a < t.length) { s = u.slice(0, a); for (var v = a; v < t.length; v++) { var l = t[v]; s.push(h[l]), delete h[l] } s.push(h) } else s = u; return r.apply(i, s) } }, makeKeywordArgs: function (t) { return t.__keywords = !0, t }, numArgs: c, suppressValue: function (t, n) { return t = void 0 !== t && null !== t ? t : "", !n || t instanceof s || (t = i.escape(t.toString())), t }, ensureDefined: function (t, n, r) { if (null === t || void 0 === t) throw new i.TemplateError("attempted to output null or undefined value", n + 1, r + 1); return t }, memberLookup: function (t, n) { if (void 0 !== t && null !== t) return "function" == typeof t[n] ? function () { for (var r = arguments.length, i = Array(r), e = 0; e < r; e++)i[e] = arguments[e]; return t[n].apply(t, i) } : t[n] }, contextOrFrameLookup: function (t, n, r) { var i = n.lookup(r); return void 0 !== i ? i : t.lookup(r) }, callWrap: function (t, n, r, i) { if (!t) throw Error("Unable to call `" + n + "`, which is undefined or falsey"); if ("function" != typeof t) throw Error("Unable to call `" + n + "`, which is not a function"); return t.apply(r, i) }, handleError: function (t, n, r) { return t.lineno ? t : new i.TemplateError(t, n, r) }, isArray: i.isArray, keys: i.keys, SafeString: s, copySafeness: function (t, n) { return t instanceof s ? new s(n) : n.toString() }, markSafe: function (t) { var n = typeof t; return "string" === n ? new s(t) : "function" !== n ? t : function (n) { var r = t.apply(this, arguments); return "string" == typeof r ? new s(r) : r } }, asyncEach: function (t, n, r, e) { if (i.isArray(t)) { var u = t.length; i.asyncIter(t, function (t, i, e) { switch (n) { case 1: r(t, i, u, e); break; case 2: r(t[0], t[1], i, u, e); break; case 3: r(t[0], t[1], t[2], i, u, e); break; default: t.push(i, u, e), r.apply(this, t) } }, e) } else i.asyncFor(t, function (t, n, i, e, u) { r(t, n, i, e, u) }, e) }, asyncAll: function (t, n, r, e) { var u, o, f = 0; function c(t, n) { f++, o[t] = n, f === u && e(null, o.join("")) } if (i.isArray(t)) if (u = t.length, o = Array(u), 0 === u) e(null, ""); else for (var s = 0; s < t.length; s++) { var a = t[s]; switch (n) { case 1: r(a, s, u, c); break; case 2: r(a[0], a[1], s, u, c); break; case 3: r(a[0], a[1], a[2], s, u, c); break; default: a.push(s, u, c), r.apply(this, a) } } else { var h = i.keys(t || {}); if (u = h.length, o = Array(u), 0 === u) e(null, ""); else for (var v = 0; v < h.length; v++) { var l = h[v]; r(l, t[l], v, u, c) } } }, inOperator: i.inOperator, fromIterator: function (t) { return "object" != typeof t || null === t || i.isArray(t) ? t : u && Symbol.iterator in t ? e(t) : t } } }, function (t, n, r) { "use strict"; var i = function (t) { var n, r; function i(n) { var r; return (r = t.call(this) || this).precompiled = n || {}, r } return r = t, (n = i).prototype = Object.create(r.prototype), n.prototype.constructor = n, n.__proto__ = r, i.prototype.getSource = function (t) { return this.precompiled[t] ? { src: { type: "code", obj: this.precompiled[t] }, path: t } : null }, i }(r(4)); t.exports = { PrecompiledLoader: i } }, function (t, n, r) { "use strict"; var i = r(0), e = r(5).EmitterObj; t.exports = function (t) { var n, r; function e() { return t.apply(this, arguments) || this } r = t, (n = e).prototype = Object.create(r.prototype), n.prototype.constructor = n, n.__proto__ = r; var u = e.prototype; return u.resolve = function (t, n) { return i.resolve(i.dirname(t), n) }, u.isRelative = function (t) { return 0 === t.indexOf("./") || 0 === t.indexOf("../") }, e }(e) }, function (t, n, r) { "use strict"; function i(t, n) { for (var r = 0; r < n.length; r++) { var i = n[r]; i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } function e(t, n, r) { return n && i(t.prototype, n), r && i(t, r), t } function u(t, n) { t.prototype = Object.create(n.prototype), t.prototype.constructor = t, t.__proto__ = n } var o = r(13), f = r(1); function c(t, n, r) { r = r || {}, f.keys(r).forEach(function (n) { var i, e; r[n] = (i = t.prototype[n], e = r[n], "function" != typeof i || "function" != typeof e ? e : function () { var t = this.parent; this.parent = i; var n = e.apply(this, arguments); return this.parent = t, n }) }); var i = function (t) { function r() { return t.apply(this, arguments) || this } return u(r, t), e(r, [{ key: "typename", get: function () { return n } }]), r }(t); return f.f(i.prototype, r), i } var s = function () { function t() { this.init.apply(this, arguments) } return t.prototype.init = function () { }, t.extend = function (t, n) { return "object" == typeof t && (n = t, t = "anonymous"), c(this, t, n) }, e(t, [{ key: "typename", get: function () { return this.constructor.name } }]), t }(), a = function (t) { function n() { var n, r; return (n = r = t.call(this) || this).init.apply(n, arguments), r } return u(n, t), n.prototype.init = function () { }, n.extend = function (t, n) { return "object" == typeof t && (n = t, t = "anonymous"), c(this, t, n) }, e(n, [{ key: "typename", get: function () { return this.constructor.name } }]), n }(o); t.exports = { Obj: s, EmitterObj: a } }, function (t, n, r) { "use strict"; var i, e = r(1), u = r(7), o = u.Environment, f = u.Template, c = r(4), s = r(3), a = r(0), h = r(0), v = r(0), l = r(0), d = r(2), p = r(0), y = r(17); function b(t, n) { var r; return n = n || {}, e.isObject(t) && (n = t, t = null), s.FileSystemLoader ? r = new s.FileSystemLoader(t, { watch: n.watch, noCache: n.noCache }) : s.WebLoader && (r = new s.WebLoader(t, { useCache: n.web && n.web.useCache, async: n.web && n.web.async })), i = new o(r, n), n && n.express && i.express(n.express), i } t.exports = { Environment: o, Template: f, Loader: c, FileSystemLoader: s.FileSystemLoader, NodeResolveLoader: s.NodeResolveLoader, PrecompiledLoader: s.PrecompiledLoader, WebLoader: s.WebLoader, compiler: h, parser: v, lexer: l, runtime: d, lib: e, nodes: p, installJinjaCompat: y, configure: b, reset: function () { i = void 0 }, compile: function (t, n, r, e) { return i || b(), new f(t, n, r, e) }, render: function (t, n, r) { return i || b(), i.render(t, n, r) }, renderString: function (t, n, r) { return i || b(), i.renderString(t, n, r) }, precompile: a ? a.precompile : void 0, precompileString: a ? a.precompileString : void 0 } }, function (t, n, r) { "use strict"; function i(t, n) { t.prototype = Object.create(n.prototype), t.prototype.constructor = t, t.__proto__ = n } var e = r(8), u = r(11), o = r(1), f = r(0), c = r(12), s = r(3), a = s.FileSystemLoader, h = s.WebLoader, v = s.PrecompiledLoader, l = r(14), d = r(15), p = r(5), y = p.Obj, b = p.EmitterObj, w = r(2), m = w.handleError, g = w.Frame, j = r(16); function E(t, n, r) { e(function () { t(n, r) }) } var O = { type: "code", obj: { root: function (t, n, r, i, e) { try { e(null, "") } catch (t) { e(m(t, null, null)) } } } }, k = function (t) { function n() { return t.apply(this, arguments) || this } i(n, t); var r = n.prototype; return r.init = function (t, n) { var r = this; n = this.opts = n || {}, this.opts.dev = !!n.dev, this.opts.autoescape = null == n.autoescape || n.autoescape, this.opts.throwOnUndefined = !!n.throwOnUndefined, this.opts.trimBlocks = !!n.trimBlocks, this.opts.lstripBlocks = !!n.lstripBlocks, this.loaders = [], t ? this.loaders = o.isArray(t) ? t : [t] : a ? this.loaders = [new a("views")] : h && (this.loaders = [new h("/views")]), "undefined" != typeof window && window.nunjucksPrecompiled && this.loaders.unshift(new v(window.nunjucksPrecompiled)), this.a(), this.globals = d(), this.filters = {}, this.tests = {}, this.asyncFilters = [], this.extensions = {}, this.extensionsList = [], o.r(c).forEach(function (t) { var n = t[0], i = t[1]; return r.addFilter(n, i) }), o.r(l).forEach(function (t) { var n = t[0], i = t[1]; return r.addTest(n, i) }) }, r.a = function () { var t = this; this.loaders.forEach(function (n) { n.cache = {}, "function" == typeof n.on && (n.on("update", function (r, i) { n.cache[r] = null, t.emit("update", r, i, n) }), n.on("load", function (r, i) { t.emit("load", r, i, n) })) }) }, r.invalidateCache = function () { this.loaders.forEach(function (t) { t.cache = {} }) }, r.addExtension = function (t, n) { return n.__name = t, this.extensions[t] = n, this.extensionsList.push(n), this }, r.removeExtension = function (t) { var n = this.getExtension(t); n && (this.extensionsList = o.without(this.extensionsList, n), delete this.extensions[t]) }, r.getExtension = function (t) { return this.extensions[t] }, r.hasExtension = function (t) { return !!this.extensions[t] }, r.addGlobal = function (t, n) { return this.globals[t] = n, this }, r.getGlobal = function (t) { if (void 0 === this.globals[t]) throw Error("global not found: " + t); return this.globals[t] }, r.addFilter = function (t, n, r) { var i = n; return r && this.asyncFilters.push(t), this.filters[t] = i, this }, r.getFilter = function (t) { if (!this.filters[t]) throw Error("filter not found: " + t); return this.filters[t] }, r.addTest = function (t, n) { return this.tests[t] = n, this }, r.getTest = function (t) { if (!this.tests[t]) throw Error("test not found: " + t); return this.tests[t] }, r.resolveTemplate = function (t, n, r) { return !(!t.isRelative || !n) && t.isRelative(r) && t.resolve ? t.resolve(n, r) : r }, r.getTemplate = function (t, n, r, i, e) { var u, f = this, c = this, s = null; if (t && t.raw && (t = t.raw), o.isFunction(r) && (e = r, r = null, n = n || !1), o.isFunction(n) && (e = n, n = !1), t instanceof S) s = t; else { if ("string" != typeof t) throw Error("template names must be a string: " + t); for (var a = 0; a < this.loaders.length; a++) { var h = this.loaders[a]; if (s = h.cache[this.resolveTemplate(h, r, t)]) break } } if (s) return n && s.compile(), e ? void e(null, s) : s; return o.asyncIter(this.loaders, function (n, i, e, u) { function o(t, r) { t ? u(t) : r ? (r.loader = n, u(null, r)) : e() } t = c.resolveTemplate(n, r, t), n.async ? n.getSource(t, o) : o(null, n.getSource(t)) }, function (r, o) { if (o || r || i || (r = Error("template not found: " + t)), r) { if (e) return void e(r); throw r } var c; o ? (c = new S(o.src, f, o.path, n), o.noCache || (o.loader.cache[t] = c)) : c = new S(O, f, "", n), e ? e(null, c) : u = c }), u }, r.express = function (t) { return j(this, t) }, r.render = function (t, n, r) { o.isFunction(n) && (r = n, n = null); var i = null; return this.getTemplate(t, function (t, e) { if (t && r) E(r, t); else { if (t) throw t; i = e.render(n, r) } }), i }, r.renderString = function (t, n, r, i) { return o.isFunction(r) && (i = r, r = {}), new S(t, this, (r = r || {}).path).render(n, i) }, r.waterfall = function (t, n, r) { return u(t, n, r) }, n }(b), A = function (t) { function n() { return t.apply(this, arguments) || this } i(n, t); var r = n.prototype; return r.init = function (t, n, r) { var i = this; this.env = r || new k, this.ctx = o.extend({}, t), this.blocks = {}, this.exported = [], o.keys(n).forEach(function (t) { i.addBlock(t, n[t]) }) }, r.lookup = function (t) { return t in this.env.globals && !(t in this.ctx) ? this.env.globals[t] : this.ctx[t] }, r.setVariable = function (t, n) { this.ctx[t] = n }, r.getVariables = function () { return this.ctx }, r.addBlock = function (t, n) { return this.blocks[t] = this.blocks[t] || [], this.blocks[t].push(n), this }, r.getBlock = function (t) { if (!this.blocks[t]) throw Error('unknown block "' + t + '"'); return this.blocks[t][0] }, r.getSuper = function (t, n, r, i, e, u) { var f = o.indexOf(this.blocks[n] || [], r), c = this.blocks[n][f + 1]; if (-1 === f || !c) throw Error('no super block available for "' + n + '"'); c(t, this, i, e, u) }, r.addExport = function (t) { this.exported.push(t) }, r.getExported = function () { var t = this, n = {}; return this.exported.forEach(function (r) { n[r] = t.ctx[r] }), n }, n }(y), S = function (t) { function n() { return t.apply(this, arguments) || this } i(n, t); var r = n.prototype; return r.init = function (t, n, r, i) { if (this.env = n || new k, o.isObject(t)) switch (t.type) { case "code": this.tmplProps = t.obj; break; case "string": this.tmplStr = t.obj; break; default: throw Error("Unexpected template object type " + t.type + "; expected 'code', or 'string'") } else { if (!o.isString(t)) throw Error("src must be a string or an object describing the source"); this.tmplStr = t } if (this.path = r, i) try { this.h() } catch (t) { throw o.t(this.path, this.env.opts.dev, t) } else this.compiled = !1 }, r.render = function (t, n, r) { var i = this; "function" == typeof t ? (r = t, t = {}) : "function" == typeof n && (r = n, n = null); var e = !n; try { this.compile() } catch (t) { var u = o.t(this.path, this.env.opts.dev, t); if (r) return E(r, u); throw u } var f = new A(t || {}, this.blocks, this.env), c = n ? n.push(!0) : new g; c.topLevel = !0; var s = null, a = !1; return this.rootRenderFunc(this.env, f, c, w, function (t, n) { if (a) { if (r) return; throw t } if (t && (t = o.t(i.path, i.env.opts.dev, t), a = !0), r) e ? E(r, t, n) : r(t, n); else { if (t) throw t; s = n } }), s }, r.getExported = function (t, n, r) { "function" == typeof t && (r = t, t = {}), "function" == typeof n && (r = n, n = null); try { this.compile() } catch (t) { if (r) return r(t); throw t } var i = n ? n.push() : new g; i.topLevel = !0; var e = new A(t || {}, this.blocks, this.env); this.rootRenderFunc(this.env, e, i, w, function (t) { t ? r(t, null) : r(null, e.getExported()) }) }, r.compile = function () { this.compiled || this.h() }, r.h = function () { var t; if (this.tmplProps) t = this.tmplProps; else { var n = f.compile(this.tmplStr, this.env.asyncFilters, this.env.extensionsList, this.path, this.env.opts); t = Function(n)() } this.blocks = this.v(t), this.rootRenderFunc = t.root, this.compiled = !0 }, r.v = function (t) { var n = {}; return o.keys(t).forEach(function (r) { "b_" === r.slice(0, 2) && (n[r.slice(2)] = t[r]) }), n }, n }(y); t.exports = { Environment: k, Template: S } }, function (t, n, r) { "use strict"; var i = r(9), e = [], u = [], o = i.makeRequestCallFromTimer(function () { if (u.length) throw u.shift() }); function f(t) { var n; (n = e.length ? e.pop() : new c).task = t, i(n) } function c() { this.task = null } t.exports = f, c.prototype.call = function () { try { this.task.call() } catch (t) { f.onerror ? f.onerror(t) : (u.push(t), o()) } finally { this.task = null, e[e.length] = this } } }, function (t, n, r) { "use strict"; !function (n) { function r(t) { e.length || (i(), !0), e[e.length] = t } t.exports = r; var i, e = [], u = 0, o = 1024; function f() { for (; u < e.length;) { var t = u; if (u += 1, e[t].call(), u > o) { for (var n = 0, r = e.length - u; n < r; n++)e[n] = e[n + u]; e.length -= u, u = 0 } } e.length = 0, u = 0, !1 } var c, s, a, h = void 0 !== n ? n : self, v = h.MutationObserver || h.WebKitMutationObserver; function l(t) { return function () { var n = setTimeout(i, 0), r = setInterval(i, 50); function i() { clearTimeout(n), clearInterval(r), t() } } } "function" == typeof v ? (c = 1, s = new v(f), a = document.createTextNode(""), s.observe(a, { characterData: !0 }), i = function () { c = -c, a.data = c }) : i = l(f), r.requestFlush = i, r.makeRequestCallFromTimer = l }(r(10)) }, function (t, n) { var r; r = function () { return this }(); try { r = r || Function("return this")() || (0, eval)("this") } catch (t) { "object" == typeof window && (r = window) } t.exports = r }, function (t, n, r) { var i; !function (r) { "use strict"; var e = function () { var t = Array.prototype.slice.call(arguments); "function" == typeof t[0] && t[0].apply(null, t.splice(1)) }, u = function (t) { "function" == typeof setImmediate ? setImmediate(t) : "undefined" != typeof process && process.nextTick ? process.nextTick(t) : setTimeout(t, 0) }, o = Array.isArray || function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, f = function (t, n, r) { var i = r ? u : e; if (n = n || function () { }, !o(t)) return n(Error("First argument to waterfall must be an array of functions")); if (!t.length) return n(); var f = function (t) { return function (r) { if (r) n.apply(null, arguments), n = function () { }; else { var e = Array.prototype.slice.call(arguments, 1), u = t.next(); u ? e.push(f(u)) : e.push(n), i(function () { t.apply(null, e) }) } } }; f(function (t) { var n = function (r) { var i = function () { return t.length && t[r].apply(null, arguments), i.next() }; return i.next = function () { return r < t.length - 1 ? n(r + 1) : null }, i }; return n(0) }(t))() }; void 0 === (i = function () { return f }.apply(n, [])) || (t.exports = i) }() }, function (t, n, r) { "use strict"; var i = r(1), e = r(2); function u(t, n) { return null === t || void 0 === t || !1 === t ? n : t } function o(t) { return t != t } function f(t) { var n = (t = u(t, "")).toLowerCase(); return e.copySafeness(t, n.charAt(0).toUpperCase() + n.slice(1)) } function c(t) { if (i.isString(t)) return t.split(""); if (i.isObject(t)) return i.r(t || {}).map(function (t) { return { key: t[0], value: t[1] } }); if (i.isArray(t)) return t; throw new i.TemplateError("list filter: type not iterable") } function s(t) { return e.copySafeness(t, t.replace(/^\s*|\s*$/g, "")) } (n = t.exports = {}).abs = Math.abs, n.batch = function (t, n, r) { var i, e = [], u = []; for (i = 0; i < t.length; i++)i % n == 0 && u.length && (e.push(u), u = []), u.push(t[i]); if (u.length) { if (r) for (i = u.length; i < n; i++)u.push(r); e.push(u) } return e }, n.capitalize = f, n.center = function (t, n) { if (t = u(t, ""), n = n || 80, t.length >= n) return t; var r = n - t.length, o = i.repeat(" ", r / 2 - r % 2), f = i.repeat(" ", r / 2); return e.copySafeness(t, o + t + f) }, n.default = function (t, n, r) { return r ? t || n : void 0 !== t ? t : n }, n.dictsort = function (t, n, r) { if (!i.isObject(t)) throw new i.TemplateError("dictsort filter: val must be an object"); var e, u = []; for (var o in t) u.push([o, t[o]]); if (void 0 === r || "key" === r) e = 0; else { if ("value" !== r) throw new i.TemplateError("dictsort filter: You can only sort by either key or value"); e = 1 } return u.sort(function (t, r) { var u = t[e], o = r[e]; return n || (i.isString(u) && (u = u.toUpperCase()), i.isString(o) && (o = o.toUpperCase())), u > o ? 1 : u === o ? 0 : -1 }), u }, n.dump = function (t, n) { return JSON.stringify(t, null, n) }, n.escape = function (t) { return t instanceof e.SafeString ? t : (t = null === t || void 0 === t ? "" : t, e.markSafe(i.escape(t.toString()))) }, n.safe = function (t) { return t instanceof e.SafeString ? t : (t = null === t || void 0 === t ? "" : t, e.markSafe(t.toString())) }, n.first = function (t) { return t[0] }, n.forceescape = function (t) { return t = null === t || void 0 === t ? "" : t, e.markSafe(i.escape(t.toString())) }, n.groupby = function (t, n) { return i.groupBy(t, n) }, n.indent = function (t, n, r) { if ("" === (t = u(t, ""))) return ""; n = n || 4; var o = t.split("\n"), f = i.repeat(" ", n), c = o.map(function (t, n) { return 0 !== n || r ? "" + f + t + "\n" : t + "\n" }).join(""); return e.copySafeness(t, c) }, n.join = function (t, n, r) { return n = n || "", r && (t = i.map(t, function (t) { return t[r] })), t.join(n) }, n.last = function (t) { return t[t.length - 1] }, n.length = function (t) { var n = u(t, ""); return void 0 !== n ? "function" == typeof Map && n instanceof Map || "function" == typeof Set && n instanceof Set ? n.size : !i.isObject(n) || n instanceof e.SafeString ? n.length : i.keys(n).length : 0 }, n.list = c, n.lower = function (t) { return (t = u(t, "")).toLowerCase() }, n.nl2br = function (t) { return null === t || void 0 === t ? "" : e.copySafeness(t, t.replace(/\r\n|\n/g, "<br />\n")) }, n.random = function (t) { return t[Math.floor(Math.random() * t.length)] }, n.rejectattr = function (t, n) { return t.filter(function (t) { return !t[n] }) }, n.selectattr = function (t, n) { return t.filter(function (t) { return !!t[n] }) }, n.replace = function (t, n, r, i) { var u = t; if (n instanceof RegExp) return t.replace(n, r); void 0 === i && (i = -1); var o = ""; if ("number" == typeof n) n = "" + n; else if ("string" != typeof n) return t; if ("number" == typeof t && (t = "" + t), "string" != typeof t && !(t instanceof e.SafeString)) return t; if ("" === n) return o = r + t.split("").join(r) + r, e.copySafeness(t, o); var f = t.indexOf(n); if (0 === i || -1 === f) return t; for (var c = 0, s = 0; f > -1 && (-1 === i || s < i);)o += t.substring(c, f) + r, c = f + n.length, s++, f = t.indexOf(n, c); return c < t.length && (o += t.substring(c)), e.copySafeness(u, o) }, n.reverse = function (t) { var n; return (n = i.isString(t) ? c(t) : i.map(t, function (t) { return t })).reverse(), i.isString(t) ? e.copySafeness(t, n.join("")) : n }, n.round = function (t, n, r) { var i = Math.pow(10, n = n || 0); return ("ceil" === r ? Math.ceil : "floor" === r ? Math.floor : Math.round)(t * i) / i }, n.slice = function (t, n, r) { for (var i = Math.floor(t.length / n), e = t.length % n, u = [], o = 0, f = 0; f < n; f++) { var c = o + f * i; f < e && o++; var s = o + (f + 1) * i, a = t.slice(c, s); r && f >= e && a.push(r), u.push(a) } return u }, n.sum = function (t, n, r) { return void 0 === r && (r = 0), n && (t = i.map(t, function (t) { return t[n] })), r + t.reduce(function (t, n) { return t + n }, 0) }, n.sort = e.makeMacro(["value", "reverse", "case_sensitive", "attribute"], [], function (t, n, r, e) { var u = i.map(t, function (t) { return t }); return u.sort(function (t, u) { var o = e ? t[e] : t, f = e ? u[e] : u; return !r && i.isString(o) && i.isString(f) && (o = o.toLowerCase(), f = f.toLowerCase()), o < f ? n ? 1 : -1 : o > f ? n ? -1 : 1 : 0 }), u }), n.string = function (t) { return e.copySafeness(t, t) }, n.striptags = function (t, n) { var r = s((t = u(t, "")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi, "")), i = ""; return i = n ? r.replace(/^ +| +$/gm, "").replace(/ +/g, " ").replace(/(\r\n)/g, "\n").replace(/\n\n\n+/g, "\n\n") : r.replace(/\s+/gi, " "), e.copySafeness(t, i) }, n.title = function (t) { var n = (t = u(t, "")).split(" ").map(function (t) { return f(t) }); return e.copySafeness(t, n.join(" ")) }, n.trim = s, n.truncate = function (t, n, r, i) { var o = t; if (t = u(t, ""), n = n || 255, t.length <= n) return t; if (r) t = t.substring(0, n); else { var f = t.lastIndexOf(" ", n); -1 === f && (f = n), t = t.substring(0, f) } return t += void 0 !== i && null !== i ? i : "...", e.copySafeness(o, t) }, n.upper = function (t) { return (t = u(t, "")).toUpperCase() }, n.urlencode = function (t) { var n = encodeURIComponent; return i.isString(t) ? n(t) : (i.isArray(t) ? t : i.r(t)).map(function (t) { var r = t[0], i = t[1]; return n(r) + "=" + n(i) }).join("&") }; var a = /^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/, h = /^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i, v = /^https?:\/\/.*$/, l = /^www\./, d = /\.(?:org|net|com)(?:\:|\/|$)/; n.urlize = function (t, n, r) { o(n) && (n = 1 / 0); var i = !0 === r ? ' rel="nofollow"' : ""; return t.split(/(\s+)/).filter(function (t) { return t && t.length }).map(function (t) { var r = t.match(a), e = r ? r[1] : t, u = e.substr(0, n); return v.test(e) ? '<a href="' + e + '"' + i + ">" + u + "</a>" : l.test(e) ? '<a href="http://' + e + '"' + i + ">" + u + "</a>" : h.test(e) ? '<a href="mailto:' + e + '">' + e + "</a>" : d.test(e) ? '<a href="http://' + e + '"' + i + ">" + u + "</a>" : t }).join("") }, n.wordcount = function (t) { var n = (t = u(t, "")) ? t.match(/\w+/g) : null; return n ? n.length : null }, n.float = function (t, n) { var r = parseFloat(t); return o(r) ? n : r }, n.int = function (t, n) { var r = parseInt(t, 10); return o(r) ? n : r }, n.d = n.default, n.e = n.escape }, function (t, n, r) { "use strict"; var i, e = "object" == typeof Reflect ? Reflect : null, u = e && "function" == typeof e.apply ? e.apply : function (t, n, r) { return Function.prototype.apply.call(t, n, r) }; i = e && "function" == typeof e.ownKeys ? e.ownKeys : Object.getOwnPropertySymbols ? function (t) { return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)) } : function (t) { return Object.getOwnPropertyNames(t) }; var o = Number.isNaN || function (t) { return t != t }; function f() { f.init.call(this) } t.exports = f, f.EventEmitter = f, f.prototype.y = void 0, f.prototype.b = 0, f.prototype.w = void 0; var c = 10; function s(t) { return void 0 === t.w ? f.defaultMaxListeners : t.w } function a(t, n, r, i) { var e, u, o; if ("function" != typeof r) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof r); if (void 0 === (u = t.y) ? (u = t.y = Object.create(null), t.b = 0) : (void 0 !== u.newListener && (t.emit("newListener", n, r.listener ? r.listener : r), u = t.y), o = u[n]), void 0 === o) o = u[n] = r, ++t.b; else if ("function" == typeof o ? o = u[n] = i ? [r, o] : [o, r] : i ? o.unshift(r) : o.push(r), (e = s(t)) > 0 && o.length > e && !o.warned) { o.warned = !0; var f = Error("Possible EventEmitter memory leak detected. " + o.length + " " + n + " listeners added. Use emitter.setMaxListeners() to increase limit"); f.name = "MaxListenersExceededWarning", f.emitter = t, f.type = n, f.count = o.length, console && console.warn && console.warn(f) } return t } function h(t, n, r) { var i = { fired: !1, wrapFn: void 0, target: t, type: n, listener: r }, e = function () { for (var t = [], n = 0; n < arguments.length; n++)t.push(arguments[n]); this.fired || (this.target.removeListener(this.type, this.wrapFn), this.fired = !0, u(this.listener, this.target, t)) }.bind(i); return e.listener = r, i.wrapFn = e, e } function v(t, n, r) { var i = t.y; if (void 0 === i) return []; var e = i[n]; return void 0 === e ? [] : "function" == typeof e ? r ? [e.listener || e] : [e] : r ? function (t) { for (var n = Array(t.length), r = 0; r < n.length; ++r)n[r] = t[r].listener || t[r]; return n }(e) : d(e, e.length) } function l(t) { var n = this.y; if (void 0 !== n) { var r = n[t]; if ("function" == typeof r) return 1; if (void 0 !== r) return r.length } return 0 } function d(t, n) { for (var r = Array(n), i = 0; i < n; ++i)r[i] = t[i]; return r } Object.defineProperty(f, "defaultMaxListeners", { enumerable: !0, get: function () { return c }, set: function (t) { if ("number" != typeof t || t < 0 || o(t)) throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + t + "."); c = t } }), f.init = function () { void 0 !== this.y && this.y !== Object.getPrototypeOf(this).y || (this.y = Object.create(null), this.b = 0), this.w = this.w || void 0 }, f.prototype.setMaxListeners = function (t) { if ("number" != typeof t || t < 0 || o(t)) throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + t + "."); return this.w = t, this }, f.prototype.getMaxListeners = function () { return s(this) }, f.prototype.emit = function (t) { for (var n = [], r = 1; r < arguments.length; r++)n.push(arguments[r]); var i = "error" === t, e = this.y; if (void 0 !== e) i = i && void 0 === e.error; else if (!i) return !1; if (i) { var o; if (n.length > 0 && (o = n[0]), o instanceof Error) throw o; var f = Error("Unhandled error." + (o ? " (" + o.message + ")" : "")); throw f.context = o, f } var c = e[t]; if (void 0 === c) return !1; if ("function" == typeof c) u(c, this, n); else { var s = c.length, a = d(c, s); for (r = 0; r < s; ++r)u(a[r], this, n) } return !0 }, f.prototype.addListener = function (t, n) { return a(this, t, n, !1) }, f.prototype.on = f.prototype.addListener, f.prototype.prependListener = function (t, n) { return a(this, t, n, !0) }, f.prototype.once = function (t, n) { if ("function" != typeof n) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof n); return this.on(t, h(this, t, n)), this }, f.prototype.prependOnceListener = function (t, n) { if ("function" != typeof n) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof n); return this.prependListener(t, h(this, t, n)), this }, f.prototype.removeListener = function (t, n) { var r, i, e, u, o; if ("function" != typeof n) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof n); if (void 0 === (i = this.y)) return this; if (void 0 === (r = i[t])) return this; if (r === n || r.listener === n) 0 == --this.b ? this.y = Object.create(null) : (delete i[t], i.removeListener && this.emit("removeListener", t, r.listener || n)); else if ("function" != typeof r) { for (e = -1, u = r.length - 1; u >= 0; u--)if (r[u] === n || r[u].listener === n) { o = r[u].listener, e = u; break } if (e < 0) return this; 0 === e ? r.shift() : function (t, n) { for (; n + 1 < t.length; n++)t[n] = t[n + 1]; t.pop() }(r, e), 1 === r.length && (i[t] = r[0]), void 0 !== i.removeListener && this.emit("removeListener", t, o || n) } return this }, f.prototype.off = f.prototype.removeListener, f.prototype.removeAllListeners = function (t) { var n, r, i; if (void 0 === (r = this.y)) return this; if (void 0 === r.removeListener) return 0 === arguments.length ? (this.y = Object.create(null), this.b = 0) : void 0 !== r[t] && (0 == --this.b ? this.y = Object.create(null) : delete r[t]), this; if (0 === arguments.length) { var e, u = Object.keys(r); for (i = 0; i < u.length; ++i)"removeListener" !== (e = u[i]) && this.removeAllListeners(e); return this.removeAllListeners("removeListener"), this.y = Object.create(null), this.b = 0, this } if ("function" == typeof (n = r[t])) this.removeListener(t, n); else if (void 0 !== n) for (i = n.length - 1; i >= 0; i--)this.removeListener(t, n[i]); return this }, f.prototype.listeners = function (t) { return v(this, t, !0) }, f.prototype.rawListeners = function (t) { return v(this, t, !1) }, f.listenerCount = function (t, n) { return "function" == typeof t.listenerCount ? t.listenerCount(n) : l.call(t, n) }, f.prototype.listenerCount = l, f.prototype.eventNames = function () { return this.b > 0 ? i(this.y) : [] } }, function (t, n, r) { "use strict"; var i = r(2).SafeString; n.callable = function (t) { return "function" == typeof t }, n.defined = function (t) { return void 0 !== t }, n.divisibleby = function (t, n) { return t % n == 0 }, n.escaped = function (t) { return t instanceof i }, n.equalto = function (t, n) { return t === n }, n.eq = n.equalto, n.sameas = n.equalto, n.even = function (t) { return t % 2 == 0 }, n.falsy = function (t) { return !t }, n.ge = function (t, n) { return t >= n }, n.greaterthan = function (t, n) { return t > n }, n.gt = n.greaterthan, n.le = function (t, n) { return t <= n }, n.lessthan = function (t, n) { return t < n }, n.lt = n.lessthan, n.lower = function (t) { return t.toLowerCase() === t }, n.ne = function (t, n) { return t !== n }, n.null = function (t) { return null === t }, n.number = function (t) { return "number" == typeof t }, n.odd = function (t) { return t % 2 == 1 }, n.string = function (t) { return "string" == typeof t }, n.truthy = function (t) { return !!t }, n.undefined = function (t) { return void 0 === t }, n.upper = function (t) { return t.toUpperCase() === t }, n.iterable = function (t) { return "undefined" != typeof Symbol ? !!t[Symbol.iterator] : Array.isArray(t) || "string" == typeof t }, n.mapping = function (t) { var n = null !== t && void 0 !== t && "object" == typeof t && !Array.isArray(t); return Set ? n && !(t instanceof Set) : n } }, function (t, n, r) { "use strict"; t.exports = function () { return { range: function (t, n, r) { void 0 === n ? (n = t, t = 0, r = 1) : r || (r = 1); var i = []; if (r > 0) for (var e = t; e < n; e += r)i.push(e); else for (var u = t; u > n; u += r)i.push(u); return i }, cycler: function () { return t = Array.prototype.slice.call(arguments), n = -1, { current: null, reset: function () { n = -1, this.current = null }, next: function () { return ++n >= t.length && (n = 0), this.current = t[n], this.current } }; var t, n }, joiner: function (t) { return function (t) { t = t || ","; var n = !0; return function () { var r = n ? "" : t; return n = !1, r } }(t) } } } }, function (t, n, r) { var i = r(0); t.exports = function (t, n) { function r(t, n) { if (this.name = t, this.path = t, this.defaultEngine = n.defaultEngine, this.ext = i.extname(t), !this.ext && !this.defaultEngine) throw Error("No default engine was specified and no extension was provided."); this.ext || (this.name += this.ext = ("." !== this.defaultEngine[0] ? "." : "") + this.defaultEngine) } return r.prototype.render = function (n, r) { t.render(this.name, n, r) }, n.set("view", r), n.set("nunjucksEnv", t), t } }, function (t, n, r) { t.exports = function () { "use strict"; var t, n, r = this.runtime, i = this.lib, e = this.compiler.Compiler, u = this.parser.Parser, o = (this.nodes, this.lexer, r.contextOrFrameLookup), f = r.memberLookup; function c(t, n) { return Object.prototype.hasOwnProperty.call(t, n) } e && (t = e.prototype.assertType), u && (n = u.prototype.parseAggregate), r.contextOrFrameLookup = function (t, n, r) { var i = o.apply(this, arguments); if (void 0 !== i) return i; switch (r) { case "True": return !0; case "False": return !1; case "None": return null; default: return } }; var s = { pop: function (t) { if (void 0 === t) return this.pop(); if (t >= this.length || t < 0) throw Error("KeyError"); return this.splice(t, 1) }, append: function (t) { return this.push(t) }, remove: function (t) { for (var n = 0; n < this.length; n++)if (this[n] === t) return this.splice(n, 1); throw Error("ValueError") }, count: function (t) { for (var n = 0, r = 0; r < this.length; r++)this[r] === t && n++; return n }, index: function (t) { var n; if (-1 === (n = this.indexOf(t))) throw Error("ValueError"); return n }, find: function (t) { return this.indexOf(t) }, insert: function (t, n) { return this.splice(t, 0, n) } }, a = { items: function () { return i.r(this) }, values: function () { return i.u(this) }, keys: function () { return i.keys(this) }, get: function (t, n) { var r = this[t]; return void 0 === r && (r = n), r }, has_key: function (t) { return c(this, t) }, pop: function (t, n) { var r = this[t]; if (void 0 === r && void 0 !== n) r = n; else { if (void 0 === r) throw Error("KeyError"); delete this[t] } return r }, popitem: function () { var t = i.keys(this); if (!t.length) throw Error("KeyError"); var n = t[0], r = this[n]; return delete this[n], [n, r] }, setdefault: function (t, n) { return void 0 === n && (n = null), t in this || (this[t] = n), this[t] }, update: function (t) { return i.f(this, t), null } }; return a.iteritems = a.items, a.itervalues = a.values, a.iterkeys = a.keys, r.memberLookup = function (t, n, e) { return 4 === arguments.length ? function (t, n, i, e) { t = t || [], null === n && (n = e < 0 ? t.length - 1 : 0), null === i ? i = e < 0 ? -1 : t.length : i < 0 && (i += t.length), n < 0 && (n += t.length); for (var u = [], o = n; !(o < 0 || o > t.length || e > 0 && o >= i || e < 0 && o <= i); o += e)u.push(r.memberLookup(t, o)); return u }.apply(this, arguments) : (t = t || {}, i.isArray(t) && c(s, n) ? s[n].bind(t) : i.isObject(t) && c(a, n) ? a[n].bind(t) : f.apply(this, arguments)) }, function () { r.contextOrFrameLookup = o, r.memberLookup = f, e && (e.prototype.assertType = t), u && (u.prototype.parseAggregate = n) } } }]) });

(function(n,t,i){"use strict";function h(n,t){if(o[n])for(var i=0;i<o[n].length;i++)o[n][i](t)}function w(n){return JSON.parse(JSON.stringify(n))}function b(n){for(var t,i=Object.keys(n),r=i.length,u={};r--;)t=i[r],u[t.toLowerCase()]=n[t];return u}function y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function ri(){var n,t;try{return(n="shmktpl:sessionId",sessionStorage.getItem(n))?sessionStorage.getItem(n):(t=y(),sessionStorage.setItem(n,t),t)}catch(i){return y()}}function ui(n){var t,i;try{return(t="shmktpl:sessionWidgetInstanceId",!n&&sessionStorage.getItem(t))?sessionStorage.getItem(t):(i=d(),sessionStorage.setItem(t,i),i)}catch(r){return d()}}function d(){function n(n){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",u=i.length,r=0;r<n;r++)t+=i.charAt(Math.floor(Math.random()*u));return t}return n(8)}function fi(){var n,t;try{return(n="shmktpl:widgetUserId",localStorage.getItem(n))?localStorage.getItem(n):(t=y(),localStorage.setItem(n,t),t)}catch(i){return console.log(i),y()}}function ei(n,t){try{var i="shmktpl:"+n;localStorage.setItem(i,t)}catch(r){console.log(r)}}function g(n){try{var t="shmktpl:"+n;return localStorage.getItem(t)}catch(i){return console.log(i),null}}function oi(n){l&&console.log.apply(console,n)}function si(n){l&&console.warn.apply(console,n)}function hi(n){l&&console.error.apply(console,n)}function c(n){return n===null||typeof n=="undefined"?!0:Array.isArray(n)?n.length===0:typeof n=="object"?Object.keys(n).length===0:typeof n=="string"?n.length===0:!1}function nt(n){return"?"+Object.keys(n).map(function(t){if(typeof n[t]!="object"&&typeof n[t]!="undefined")return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}function pt(n){var u,i,f,e;if(n.preventDefault(),u=n.currentTarget,i=b(u.dataset),!i.shsrc||!i.shinventorytype||!i.shtarget){console.error("invalid link configuration %o",u);return}f={src:i.shsrc,inventorytype:i.shinventorytype,var1:i.shvar1,zipcode:i.shzipcode,trn_id:i.shtrnId,targetBuyer:i.shtarget};e=tt(f,ci(t.body));r.getWidgetFromServer(e)}function ci(n){var i=wt(),r=t.createElement("div");return r.id=i,n.appendChild(r),i}function wt(){return"__sh__"+Math.floor(Math.random()*1e9)}function bt(n){var f=t.querySelector("#"+n),i,u;if(f)return f.innerHTML="",n;if(i=li(),i)return u=wt(),i.insertAdjacentHTML("beforebegin",'<div id="'+u+'"><\/div>'),u;r.consoleError("could not find legacy loader to inject widget into")}function li(){var r=t.getElementById("shmktpl_retrieve"),n,i;if(r!==null)return r;for(n=t.getElementsByTagName("script"),i=0;i<n.length;i++)if(n[i].src.match(/\/loader\/js/gi)||n[i].src.match(/\/retrieve/gi))return n[i];return n[n.length-1]}function tt(e,o){var l=d(),s;return r.groupStart("%ccreateNewWidget : instanceId %s, session %s, widgetUserId %s",a,l,r.currentSessionId,r.currentWidgetUserId),s={src:e.src,instanceId:l,originwidgetinstanceid:l,idx:ut,domContainer:o,matchingConfig:ai(e),sessionId:r.currentSessionId,widgetUserId:r.currentWidgetUserId,ref:r.currentPageUrl,frm:r.currentPageReferrer,widgetSearchCount:0,listingLoadCount:0,lightBoxCleared:!1,widgetLoadEventId:y(),options:e.options||{}},e.hasOwnProperty("widgetType")&&(s.widgetType=e.widgetType),e.hasOwnProperty("widgetId")&&(s.widgetId=e.widgetId),e.hasOwnProperty("widget")&&(s.widget=e.widget),e.hasOwnProperty("abTestVersion")&&(s.abTestVersion=e.abTestVersion),e.hasOwnProperty("widgetfile")&&(s.widgetFile=e.widgetfile),e.hasOwnProperty("inventorytype")&&(s.inventorytype=e.inventorytype),e.hasOwnProperty("originwidgetinstanceid")&&(s.originwidgetinstanceid=e.originwidgetinstanceid),e.hasOwnProperty("originsessionid")&&(s.sessionId=e.originsessionid),e.hasOwnProperty("data")&&e.data.hasOwnProperty("tracking")&&typeof e.data.tracking.ni_session_ref!="undefined"?s.ref=e.data.tracking.ni_session_ref:e.hasOwnProperty("session_ref")&&(s.ref=e.session_ref),e.hasOwnProperty("extraClickParams")&&typeof e.extraClickParams=="object"&&(s.extraClickParams=e.extraClickParams),s.canLoadListings=function(){return!this.isLoadingListings()&&this.isFormValid()},s.isLoadingListings=function(){return this.root.classList.contains("listingsLoading")},s.hasClass=function(n){return(" "+this.root.className+" ").indexOf(" "+n+" ")>-1},s.finalize=function(){var n=this,t;if(r.groupStart("currentWidget.finalize %s",n.instanceId),n.loadFont(),t=Object.keys(n.hiddenInputs),t.length>0)for(u=0;u<t.length;u++)n.createHiddenInput(t[u],n.hiddenInputs[t[u]]);n.checkSpecificOptions();n.options.hasOwnProperty("defaultUserAttributes")&&typeof n.options.defaultUserAttributes=="object"&&(r.groupStart("updateMatchingDtoWithPublisherDefaults"),r.log("widget default options: %o",n.options.defaultUserAttributes),n.updateMatchingDtoWithPublisherDefaults(n.options.defaultUserAttributes),r.groupEnd());n.updateFormSelectionsWithAttributeValues(n.matchingConfig);n.autoFillZipCode();n.updateDynamicContent(n.options);n.updateDynamicContent(n.matchingConfig);n.addEventListeners();r.groupEnd()},s.loadFont=function(){var t=this,i;if(t.options.hasOwnProperty("disablefonts")||t.options.disablefonts)r.warn("disabled font loading");else{if(t.options.hasOwnProperty("customfonts")&&Array.isArray(t.options.customfonts))for(i=0;i<t.options.customfonts.length;i++)t.options.customfonts[i]!==""&&(r.log("adding "+t.options.customfonts[i]),n[t.instanceId+"_fonts"].push(t.options.customfonts[i]));r.loadFont(n[t.instanceId+"_fonts"])}},s.checkSpecificOptions=function(){if(r.groupStart("checkSpecificOptions"),this.options.hasOwnProperty("features"))for(var n=0;n<this.options.features.length;n++)this.addRootCssClass(this.options.features[n]);this.addRootCssClass(this.inventorytype);this.addRootCssClass(this.baseinventorytype);this.addRootCssClass(this.pagingConfig.pagingEnabled?"pagingEnabled":"pagingDisabled");this.addDeviceClass();this.checkBrowser();this.checkDeviceSpecificOptions();this.checkCategorySpecificOptions();this.checkFeatureSpecificOptions()},s.addDeviceClass=function(){var t,n;if(this.addRootCssClass("device-"+this.deviceClass),this.domContainerWidth()>0&&(n=50*Math.round(this.domContainerWidth()/50,0),this.addRootCssClass("box"+n.toString()),t=this.narrowSettingMaxWidth||650,this.deviceClass==="desktop"&&this.domContainerWidth()<t&&this.addRootCssClass("desktop-narrow"),this.domContainerWidth()>=300&&this.domContainerWidth()<=700))for(n=50*parseInt(this.domContainerWidth()/50),u=n;u<=700;u+=50)this.addRootCssClass("sh-box"+u.toString())},s.addRootCssClass=function(n){c(n)||this.root.classList.contains(n)||(r.log("%cadding css class to widget root: %c%s","color:red","font-weight:bold",n),this.root.classList.add(n))},s.checkDeviceSpecificOptions=function(){r.groupStart("checking device specific options...");var n=this;r.gather("#"+n.instanceId+" .device-specific").forEach(function(t){t.classList.contains(n.deviceClass)||(r.log("missing required device class - detaching element %o",t),r.detachElement(t))})},s.checkBrowser=function(){/MSIE|Trident/.test(n.navigator.userAgent)&&this.addRootCssClass("msie")},s.checkCategorySpecificOptions=function(){var n=this;r.groupStart("checking category specific options...");r.gather("#"+n.instanceId+" .categorytype-specific").forEach(function(t){t.classList.contains(n.widgetCategoryType)||r.detachElement(t)});r.gather("#"+n.instanceId+" .category-specific").forEach(function(t){t.classList.contains(n.widgetCategory)||(r.log("missing required category class - detaching element %o",t),r.detachElement(t))});r.groupEnd()},s.checkFeatureSpecificOptions=function(){function i(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")>-1}var t,n;r.groupStart("checking feature specific options...");t=this;n=t.options.features||[];r.gather("#"+t.instanceId+" .feature-specific").forEach(function(t){for(var f=!1,u=0,e=n.length;u<e;u++)if(i(t,n[u])){f=!0;break}f||(r.log("missing required feature class %o- detaching element %o",n,t),r.detachElement(t))});r.groupEnd()},s.bindAttributesToElement=function(n,t){var f=this,u=n.dataset.shmktplBind,i,e,o,s;typeof t[u.toLowerCase()]!="undefined"&&t[u.toLowerCase()]!==""&&(i=decodeURIComponent(t[u.toLowerCase()]),u.toLowerCase()==="coveragetype"&&i.toLowerCase()==="homeowners"&&(i="home"),typeof n.dataset.shmktplBindFormat!="undefined"?n.dataset.shmktplBindFormat==="money"&&(i=r.formatMoney(i,0)):typeof n.dataset.shmktplBindToInputOption!="undefined"&&n.dataset.shmktplBindToInputOption==="1"&&(e=f.root.querySelector('.shmktpl-input-option[data-attribute-name="'+u+'"][data-checked-value="'+i+'"]'),e?i=e.textContent:(o=f.root.querySelector('select.shmktpl-form-input[data-attribute-name="'+u+'"]'),o&&(s=f.getSelectedDropdownOption(o),s&&(i=s.textContent)))),n.innerHTML=i,r.gather("[data-shmktpl-bind]",n).forEach(function(n){f.bindAttributesToElement(n,t)}))},s.updateDynamicContent=function(n){var t=this,i;r.groupStart("currentWidget.updateDynamicContent for instance %s",t.instanceId);i=b(n);r.log("with attribute values = %o",i);r.gather("#"+t.instanceId+" [data-shmktpl-bind]").forEach(function(n){t.bindAttributesToElement(n,i)});r.groupEnd()},s.isFormValid=function(){var t=this,n;return(r.groupStart("Validating form for widget %s",t.instanceId),n=[],r.gather("#"+t.instanceId+' .shmktpl-form-input[data-shmktpl-required="true"]').forEach(function(t){if(r.log("validating form element %o",t),typeof t.dataset.attributeName!="undefined"){var i=t.dataset.attributeName.toLowerCase();i.indexOf("zipcode")>-1&&t.value.length<5?n.push(t):i.indexOf("age")>-1&&(t.value.length<2||parseInt(t.value,10)<16)?n.push(t):t.value===""&&n.push(t)}else r.consoleError("error validating form element %o, no data-attribute-name property assigned",t)}),r.groupEnd(),n.length>0)?(r.displayErrors(n),!1):!0},s.updateMatchingDtoWithFormSelections=function(){var n=this;r.groupStart("currentWidget.updateMatchingDtoWithFormSelections for instance %s",n.instanceId);r.gather("#"+n.instanceId+" .shmktpl-form-input").forEach(function(t){var f=t.tagName,u=t.type,e=t.dataset.attributeName,i,o;typeof e!="undefined"&&(f==="SELECT"?(o=n.getSelectedDropdownOption(t),i=o?o.value:""):f==="INPUT"?u==="radio"?t.checked&&(i=typeof t.dataset.checkedValue!="undefined"?t.dataset.checkedValue:t.value):u==="checkbox"?t.checked?i=typeof t.dataset.checkedValue!="undefined"?t.dataset.checkedValue:t.value:typeof t.dataset.uncheckedValue!="undefined"&&(i=t.dataset.uncheckedValue):u==="text"||u==="tel"||u==="hidden"||u==="number"?i=t.value:r.consoleError("can't update matching variable from form input: %s-%s, tagName=%s, inputType=%s",n.instanceId,e,f,u):typeof t.dataset.checkedValue!="undefined"?t.classList.contains("active")?i=t.dataset.checkedValue:typeof t.dataset.uncheckedValue!="undefined"&&(i=t.dataset.uncheckedValue):r.warn("can't update matching variable from form input: %o",t),typeof i!="undefined"&&n.updateMatchingDtoAttributeValue(e,i))});r.groupEnd()},s.autoFillZipCode=function(){var n=this,t=n.root.querySelector('input[data-attribute-name="zipcode"][data-geo-detect="true"]');t&&(t.value===""?r.loadGeo(function(t){n.updateMatchingDtoAttributeValue("zipcode",t.zipcode);n.updateFormSelectionsWithAttributeValues(t);n.updateDynamicContent(t);typeof n.autoFillZipCodeComplete=="function"?(r.log("%ccurrentWidget has autoFillZipCodeComplete handler, executing it",a),n.autoFillZipCodeComplete()):r.log("%ccurrentWidget does not have autoFillZipCodeComplete handler",a)}):typeof n.autoFillZipCodeComplete=="function"?(r.warn("currentWidget %s has zip code filled already, and has autoFillZipCodeComplete handler, executing it",n.instanceId),n.autoFillZipCodeComplete()):r.warn("currentWidget %s does not have autoFillZipCodeComplete handler",n.instanceId))},s.createHiddenInput=function(n,i){var f=this,u;f.root.querySelector('.shmktpl-form-input[data-attribute-name="'+n+'"]')||(r.warn("currentWidget %s, createHiddenInput name='%s', value='%s'",f.instanceId,n,i),u=t.createElement("input"),u.type="hidden",u.classList.add("shmktpl-form-input"),u.dataset.attributeName=n,u.value=i.toString(),f.root.appendChild(u))},s.showSingleBuyerRedirect=function(n){function i(){var i=4,u=setInterval(function(){i<=0?(clearInterval(u),t.root.querySelector("#countdown").style.display="none",t.root.querySelector("#showMeOtherOptions").style.display="none",t.root.querySelector("#loader").style.display="block",g("singleBuyerRedirectDisabled")&&g("singleBuyerRedirectDisabled")!=="0"||r.click(1,n.listing[0].clickurl,{openInSameWindow:!0})):t.root.querySelector("#countdown").innerHTML="Redirecting in "+i+" seconds";i-=1},1e3)}var t=this;n.widgetUserAttributes.hasOwnProperty("singlebuyerredirectmarkup")?(t.root.innerHTML=n.widgetUserAttributes.singlebuyerredirectmarkup,setTimeout(function(){var n=t.root.querySelector("#singleBuyerRedirectModal");r.fadeInElement(n,i)},500)):r.click(1,n.listing[0].clickurl,{openInSameWindow:!0})},s.showListings=function(){function e(){var u,t,i;if(!c(n.currentMatchingResult.listingset.listing)){for(u={sdt:n.currentMatchingResult.listingset.sdt,sid:n.currentMatchingResult.listingset.searchid,ref:r.currentPageUrl,frm:r.currentPageReferrer,widgetPage:n.currentPage,widgetUserId:r.currentWidgetUserId,imps:[]},t=0;t<n.currentMatchingResult.listingset.listing.length;t++)for(u.imps.push({i:n.currentMatchingResult.listingset.listing[t].impressionid,r:n.currentMatchingResult.listingset.listing[t].rank,s:n.currentMatchingResult.listingset.listing[t].has_been_seen}),i=0;i<n.originalMatchingResult.listingset.listing.length;i++)n.originalMatchingResult.listingset.listing[i].impressionid===n.currentMatchingResult.listingset.listing[t].impressionid&&(n.originalMatchingResult.listingset.listing[i].has_been_seen=!0);return r.log("impsShownDto = %o",u),u}}var n=this,t,f,u;if(r.log("final listings to bind: %o",n.currentMatchingResult),n.insideContainer.innerHTML=i.render(n.templateName+".njk",n.currentMatchingResult),!c(n.currentMatchingResult.listingset.listing)){for(t=e(),f=!1,u=0;u<t.imps.length;u++)t.imps[u].s||(f=!0);f&&(r.log("%cimpression pixels = %o","color:blue",t),it(ni,t,null,!0))}h("sh.listingsRendered",n.currentMatchingResult)},s.showPage=function(n){r.warn("show '%s'",n);var t=this,i=!1;n==="next"&&t.currentPage<t.currentMatchingResult.listingset.numPages?(i=!0,t.currentPage+=1):n==="prev"&&t.currentPage>1?(i=!0,t.currentPage-=1):n==="first"&&(i=!0,t.currentPage=1);i?(t.pageListings(),t.showListings()):r.warn("cannot page")},s.renderListings=function(n,f,e,o){var s=this,a,y,c,p,l;if(r.groupStart("%ccurrentWidget.renderListings","color:blue"),r.log("%clistingCount = %s","color:blue",n.listingset.listing.length),typeof s.extraClickParams=="object"&&(a=nt(s.extraClickParams),a.length>1))for(u=0;u<n.listingset.listing.length;u++)y=n.listingset.listing[u].clickurl,n.listingset.listing[u].clickurl=y+(y.indexOf("?")>0?"&"+a.substring(1):a),r.log("modifiying click url to: %s",n.listingset.listing[u].clickurl);if(s.originalMatchingResult=n,s.currentSearchStatusId=n.listingset.searchStatusId||v,s.baseSearchStatusId=n.listingset.baseSearchStatusId||v,ti&&(n.listingset.additional_tracking="%7B%22searchStatusId%22%3A%225%22%2C%22baseSearchStatusId%22%3A%225%22%2C%22sdt%22%3A%22637821630338923617%22%2C%22publisherAdditionalTracking%22%3A%22%257B%2522searchStatusId%2522%253A%252239%2522%252C%2522baseSearchStatusId%2522%253A%25221%2522%252C%2522publisherAdditionalTracking%2522%253A%2522%25257B%252522widgetUserId%252522%25253A%2525225e43830c-ae90-45f8-bb11-97adcbe0ad71%252522%25252C%252522js_session%252522%25253A%25252272b841ba-9781-4e5e-8a88-1edaf018eaab%252522%25252C%252522widgetId%252522%25253A373%25252C%252522widgetConfigurationId%252522%25253A24671%25252C%252522widgetInstanceId%252522%25253A%252522foikKXIn%252522%25252C%252522widgetContainerId%252522%25253A%252522qsWidgetContainer%252522%25252C%252522widgetContainerWidth%252522%25253A1140%25252C%252522widgetDefaultSearchStatusId%252522%25253A39%25252C%252522originWidgetInstanceId%252522%25253A%252522ECxeYaCj%252522%25252C%252522widgetSearchCount%252522%25253A0%25252C%252522widgetInventoryType%252522%25253A%252522experian-nodatapass-standalone%252522%25252C%252522abTestVersion%252522%25253A%25257B%252522widgetAbTestWidgetId%252522%25253A2294%25252C%252522widgetAbTestId%252522%25253A2106%25252C%252522widgetId%252522%25253A373%25252C%252522frequency%252522%25253A75%25252C%252522flag%252522%25253A%252522A%252522%25252C%252522expires%252522%25253A1646670872547%25257D%25257D%2522%257D%22%7D"),n.listingset.hasOwnProperty("additional_tracking")&&typeof n.listingset.additional_tracking=="string")try{if(c=JSON.parse(decodeURIComponent(n.listingset.additional_tracking)),r.warn("%cadditionalTrackingObj = %o","color:blue",c),typeof c=="object"&&(c.hasOwnProperty("searchStatusId")&&(s.currentSearchStatusId=c.searchStatusId),c.hasOwnProperty("baseSearchStatusId")&&(s.baseSearchStatusId=c.baseSearchStatusId),c.hasOwnProperty("sdt")&&(s.originalMatchingResult.listingset.sdt=c.sdt),c.hasOwnProperty("publisherAdditionalTracking")&&typeof c.publisherAdditionalTracking=="string"))try{s.publisherAdditionalTracking=c.publisherAdditionalTracking;s.publisherAdditionalTrackingObj=JSON.parse(decodeURIComponent(c.publisherAdditionalTracking))}catch(w){s.publisherAdditionalTracking="";s.publisherAdditionalTrackingObj={}}}catch(b){}if(s.originalMatchingResult.listingset.hasOwnProperty("singleBuyerRedirect")&&s.originalMatchingResult.listingset.singleBuyerRedirect)s.showSingleBuyerRedirect(s.originalMatchingResult.listingset),h("sh.listingsRendered",s.originalMatchingResult);else if(s.templateName=e||s.instanceId,typeof window.nunjucksPrecompiled[s.templateName+".njk"]=="object")if(s.insideContainer=f||t.querySelector("#"+s.instanceId+" .listings-layout-container"),s.insideContainer){if(p=i.configure({autoescape:!1}),typeof o=="object")for(l=Object.keys(o),u=0;u<l.length;u++)r.log("Adding Nunjucks Global variable %s = %s",l[u],o[l[u]]),p.addGlobal(l[u],o[l[u]]);s.showPage("first");r.gather("#"+s.instanceId+" .hide-until-listings-loaded").forEach(function(n){n.classList.remove("hide-until-listings-loaded")})}else console.error("no container defined to render listings to for instance %s.  You should have an dom element with css class 'listings-layout-container' defined in your widget html markup",this.instanceId);else console.error("No precompiled nunjucks template named %s.njk",templateName);s.currentSearchStatusId!==k&&s.updateSearchStatus(t.hidden?yt:s.baseSearchStatusId);r.groupEnd()},s.pageListings=function(){var n=this,t;if(r.groupStart("%ccurrentWidget.pageListings","color:blue"),t=w(n.originalMatchingResult),t.listingset.pagingEnabled=n.pagingConfig.pagingEnabled,t.listingset.repeatImpressionEnabled=n.pagingConfig.repeatImpressionEnabled,t.listingset.currentPage=n.currentPage,t.listingset.canShowNext=n.pagingConfig.pagingEnabled&&n.currentPage<t.listingset.numPages,t.listingset.canShowPrev=n.pagingConfig.pagingEnabled&&n.currentPage>1,n.pagingConfig.pagingEnabled)if(r.log("%cpaging enabled","color:blue;"),t.listingset.listing=[],n.pagingConfig.pageBehavior.toLowerCase()==="append")for(u=0;u<n.originalMatchingResult.listingset.listing.length;u++)n.originalMatchingResult.listingset.listing[u].widgetpage<=n.currentPage&&t.listingset.listing.push(n.originalMatchingResult.listingset.listing[u]);else for(u=0;u<n.originalMatchingResult.listingset.listing.length;u++)n.originalMatchingResult.listingset.listing[u].widgetpage===n.currentPage&&t.listingset.listing.push(n.originalMatchingResult.listingset.listing[u]);else r.log("%cpaging disabled","color:red;");return n.currentMatchingResult=t},s.updateFormSelectionsWithAttributeValues=function(n){var t=this,i=b(n);r.groupStart("updateFormSelectionsWithAttributeValues for instance %s",t.instanceId);r.log("Values to bind to Form %o",i);r.gather("#"+t.instanceId+" .shmktpl-form-input").forEach(function(n){var e=n.dataset.attributeName,o,u,f;typeof e!="undefined"&&typeof i[e]!="undefined"&&(o=n.tagName,u=i[e].toString(),r.log("updating input %o with value '%s'",n,u),o==="SELECT"?t.setSelectedDropdownValue(n,u):o==="INPUT"&&typeof n.type!="undefined"?(f=n.type,f==="radio"?t.setCheckedStateForRadioGroupInputAttribute(e,u):f==="checkbox"?typeof n.dataset.checkedValue!="undefined"&&(n.checked=n.dataset.checkedValue.toLowerCase()===u.toLowerCase()):f==="text"||f==="tel"||f==="number"||f==="hidden"?n.value=u:r.consoleError("can't handle form input %o",n)):n.classList.contains("shmktpl-has-active-state")?t.setActiveStateForToggleInputAttribute(e,u):r.consoleError("can't handle form input %o",n),n.classList.remove("error"))});r.groupEnd()},s.updateMatchingDtoAttributeValue=function(n,t,i){var e=this,u,f;if(i=typeof i!="undefined"?i:!1,typeof t!="undefined")if(u=e.matchingConfig,typeof t!="string"&&(t=t.toString()),n=n.toLowerCase(),r.log("updating matching attribute '%s' to '%s'",n,t),f=!0,u.hasOwnProperty("tracking")){u.contact=u.contact||{};u.current_insurance=u.current_insurance||{};u.requested_coverage=u.requested_coverage||{};u.pet_coverage=u.pet_coverage||{};u.hasOwnProperty("drivers")&&(u.individuals=u.drivers,delete u.drivers);u.individuals=u.individuals||[];u.individuals.length===0&&u.individuals.push({});switch(n){case"age":case"agebucket":i&&(u.contact.age||u.individuals[0].age)&&(f=!1);f&&(u.contact.age=t,u.individuals[0].age=t,delete u.individuals[0].birthdate);break;case"algowidgetid":i&&u.tracking.algoWidgetId&&(f=!1);f&&(u.tracking.algoWidgetId=t);break;case"carrier":i&&u.current_insurance.currently_insured&&(f=!1);f&&(t!==""&&(u.current_insurance.currently_insured=t!=="Not Currently Insured"),u.current_insurance.carrier=t);break;case"coveragetype":i&&u.requested_coverage.coverage_type&&(f=!1);f&&(u.requested_coverage.coverage_type=t);break;case"coverageamount":i&&u.requested_coverage.coverage_amount&&(f=!1);f&&(u.requested_coverage.coverage_amount=t);break;case"creditrating":i&&u.individuals[0].self_credit_rating&&(f=!1);f&&(u.individuals[0].self_credit_rating=t);break;case"currentlyinsured":i&&u.current_insurance.currently_insured&&(f=!1);f&&(u.current_insurance.currently_insured=t);break;case"drivercount":i&&u.requested_coverage.driver_count&&(f=!1);f&&(u.requested_coverage.driver_count=t,delete u.vehicles);break;case"dui":i&&u.individuals[0].has_had_dui&&(f=!1);f&&(u.individuals[0].has_had_dui=t);break;case"education":case"edu":i&&u.individuals[0].education&&(f=!1);f&&(u.individuals[0].education=t);break;case"frm":i&&u.tracking.ni_frm_ref&&(f=!1);f&&(u.tracking.ni_frm_ref=t);break;case"gender":i&&u.individuals[0].gender&&(f=!1);f&&(u.individuals[0].gender=t);break;case"hazardousoccupation":i&&u.individuals[0].high_risk&&(f=!1);f&&(u.individuals[0].high_risk=t);break;case"homeowner":i&&u.contact.homeowner&&(f=!1);f&&(u.contact.homeowner=t);break;case"inventorytype":i&&u.tracking.inventory_type&&(f=!1);f&&(u.tracking.inventory_type=t);break;case"js_session":u.tracking.js_session=t;break;case"jsev":u.tracking.engine_version=t;break;case"married":i&&u.contact.married&&(f=!1);f&&(u.contact.married=t,delete u.individuals[0].marital_status);break;case"medicalcondition":i&&u.individuals[0].hc_other&&(f=!1);f&&(u.individuals[0].hc_other=t);break;case"military":i&&u.contact.military_affiliation&&(f=!1);f&&(u.contact.military_affiliation=t);break;case"residencetype":i&&u.contact.residence_type&&(f=!1);f&&(u.contact.residence_type=t);break;case"occupation":i&&u.individuals[0].occupation&&(f=!1);f&&(u.individuals[0].occupation=t);break;case"originwidgetinstanceid":u.tracking.originWidgetInstanceId=t;break;case"petage":i&&u.pet_coverage.pet_age&&(f=!1);f&&(u.pet_coverage.pet_age=t);break;case"petgender":i&&u.pet_coverage.pet_gender&&(f=!1);f&&(u.pet_coverage.pet_gender=t);break;case"petcount":i&&u.pet_coverage.pet_count&&(f=!1);f&&(u.pet_coverage.pet_count=t);break;case"pettype":i&&u.pet_coverage.pet_type&&(f=!1);f&&(u.pet_coverage.pet_type=t);break;case"petbreed":i&&u.pet_coverage.pet_breed&&(f=!1);f&&(u.pet_coverage.pet_breed=t);break;case"recentincidentcount":i&&u.individuals[0].num_recent_incidents&&(f=!1);f&&(u.individuals[0].num_recent_incidents=t,delete u.incidents);break;case"ref":u.tracking.ni_ref=t;break;case"rootsearchid":u.tracking.orig_srch_id=t;break;case"single_buyer_redirect":i&&u.tracking.single_buyer_redirect&&(f=!1);f&&(u.tracking.single_buyer_redirect=t);break;case"single_buyer_redirect_optout":i&&u.tracking.single_buyer_redirect_optout&&(f=!1);f&&(u.tracking.single_buyer_redirect_optout=t);break;case"sr22":i&&u.individuals[0].requires_sr22&&(f=!1);f&&(u.individuals[0].requires_sr22=t);break;case"suspension":i&&u.individuals[0].has_had_suspension&&(f=!1);f&&(u.individuals[0].has_had_suspension=t);break;case"tobacco":i&&u.individuals[0].tobacco_use&&(f=!1);f&&(u.individuals[0].tobacco_use=t);break;case"vehiclecount":i&&u.requested_coverage.vehicle_count&&(f=!1);f&&(u.requested_coverage.vehicle_count=t,delete u.vehicles);break;case"widgetid":u.tracking.widgetId=t;break;case"widgetconfigurationid":u.tracking.widgetConfigurationId=t;break;case"widgetsearchcount":u.tracking.widgetSearchCount=t;break;case"widgetcontainerid":u.tracking.widgetContainerId=t;break;case"widgetcontainerwidth":u.tracking.widgetContainerWidth=t;break;case"widgetinstanceid":u.tracking.widgetInstanceId=t;break;case"widgetuserid":u.tracking.widgetUserId=t;break;case"wdst":u.tracking.widgetDefaultSearchStatusId=t;break;case"zipcode":i&&(u.tracking.ni_zc||u.contact.zip)&&(f=!1);f&&(u.tracking.ni_zc=t,u.contact.zip=t);break;default:r.warn("no match in switch statement to update variable %s",n)}}else{switch(n){case"agebucket":i&&(u.age||u.agebucket)&&(f=!1);f&&delete u.age;break;case"ficobucket":i&&(u.fico||u.ficobucket)&&(f=!1);f&&delete u.fico;break;default:i&&u.hasOwnProperty(n)&&(f=!1)}f&&(u[n]=encodeURIComponent(t))}},s.getMatchingDtoAttributeValue=function(n){var t=this,i="";switch(n.toLowerCase()){case"var1":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var1")?i=t.matchingConfig.tracking.ni_var1:t.matchingConfig.hasOwnProperty("var1")&&(i=t.matchingConfig.var1);break;case"var2":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var2")?i=t.matchingConfig.tracking.ni_var2:t.matchingConfig.hasOwnProperty("var2")&&(i=t.matchingConfig.var2);break;case"var3":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var3")?i=t.matchingConfig.tracking.ni_var3:t.matchingConfig.hasOwnProperty("var3")&&(i=t.matchingConfig.var3);break;case"trn_id":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_trn_id")?i=t.matchingConfig.tracking.ni_trn_id:t.matchingConfig.hasOwnProperty("ni_trn_id")?i=t.matchingConfig.ni_trn_id:t.matchingConfig.hasOwnProperty("trn_id")&&(i=t.matchingConfig.trn_id);break;case"single_buyer_redirect":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("single_buyer_redirect")?i=t.matchingConfig.tracking.single_buyer_redirect:t.matchingConfig.hasOwnProperty("single_buyer_redirect")&&(i=t.matchingConfig.single_buyer_redirect);break;case"quad_url":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_quad_url")?i=t.matchingConfig.tracking.ni_quad_url:t.matchingConfig.hasOwnProperty("ni_quad_url")?i=t.matchingConfig.ni_quad_url:t.matchingConfig.hasOwnProperty("quad_url")&&(i=t.matchingConfig.quad_url);break;case"ext_click_id":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ext_click_id")?i=t.matchingConfig.tracking.ext_click_id:t.matchingConfig.hasOwnProperty("ext_click_id")&&(i=t.matchingConfig.ext_click_id)}return i},s.finalizeMatchingConfig=function(){r.groupStart("finalizing matching configuration for widget instance %s",this.instanceId);var n=0;g("singleBuyerRedirectDisabled")==="1"&&(n=1);this.widgetSearchCount+=1;this.initialSearchStatusId!==k||this.lightBoxCleared||this.listingLoadCount!==1||(this.widgetSearchCount=1,this.lightBoxCleared=!0);this.updateMatchingDtoAttributeValue("widgetid",this.widgetId);this.updateMatchingDtoAttributeValue("widgetconfigurationid",this.widgetconfigurationid);this.updateMatchingDtoAttributeValue("algoWidgetId",this.algoWidgetId);this.updateMatchingDtoAttributeValue("widgetcontainerid",this.domContainer);this.updateMatchingDtoAttributeValue("widgetinstanceid",this.instanceId);this.updateMatchingDtoAttributeValue("originwidgetinstanceid",this.originwidgetinstanceid);this.updateMatchingDtoAttributeValue("inventorytype",this.inventorytype);this.updateMatchingDtoAttributeValue("js_session",this.sessionId);this.updateMatchingDtoAttributeValue("single_buyer_redirect_optout",n);this.updateMatchingDtoAttributeValue("widgetUserId",this.widgetUserId);this.updateMatchingDtoAttributeValue("jsev",dt);this.updateMatchingDtoAttributeValue("ref",this.ref);this.updateMatchingDtoAttributeValue("frm",this.frm);this.updateMatchingDtoAttributeValue("wdst",this.listingLoadCount===0?this.initialSearchStatusId:v);this.updateMatchingDtoAttributeValue("widgetsearchcount",this.widgetSearchCount);this.widgetSearchCount===1?this.updateMatchingDtoAttributeValue("rootsearchid",""):this.originalMatchingResult&&this.originalMatchingResult.listingset&&this.updateMatchingDtoAttributeValue("rootsearchid",this.originalMatchingResult.listingset.rootsearchid);this.domContainerWidth()>0&&this.updateMatchingDtoAttributeValue("widgetcontainerwidth",this.domContainerWidth());this.matchingConfig.hasOwnProperty("tracking")&&(delete this.matchingConfig.tracking.ip,delete this.matchingConfig.tracking.ua);r.groupEnd()},s.addEventListeners=function(){function f(n){n.target.value=n.target.value.replace(/\D/gi,"")}function u(n){var u=n.target,e,f;if(!u.classList.contains("prevent-submit")&&(r.warn("checkToggle on %o",u),u.classList.contains("shmktpl-has-active-state")&&(e=u.classList.contains("active")?u.dataset.uncheckedValue:u.dataset.checkedValue,r.log("setActiveStateForToggleInputAttribute attributeName=%s, value=%s",u.dataset.attributeName,e),i.setActiveStateForToggleInputAttribute(u.dataset.attributeName,e),typeof u.dataset.shmktplSetActiveStateFor!="undefined"&&(f=t.getElementById(u.dataset.shmktplSetActiveStateFor),f&&(e===""||f.classList.contains("active")?f.classList.remove("active"):f.classList.add("active")))),u.classList.contains("shmktpl-submit")||u.parentElement&&u.parentElement.classList.contains("shmktpl-submit")))i.onFormSubmit(n)}r.groupStart("addEventListeners");var i=this;typeof i.onFormSubmit=="function"?r.gather("#"+i.instanceId+" .shmktpl-submit").forEach(function(n){n.tagName==="SELECT"||n.tagName==="INPUT"&&typeof n.type!="undefined"&&n.type!=="button"?(r.log("adding onChange (will submit form) event listener to %o",n),n.addEventListener("change",function(t){if(n.classList.contains("prevent-submit"))r.log("blocking submit handler on %o",n);else i.onFormSubmit(t)})):(r.log("adding submit onClick (will submit form) event listener to %o",n),n.addEventListener("click",function(n){u(n)}),n.classList.contains("shmktpl-has-active-state")&&(n.addEventListener("touchmove",function(){n.dataset.touchMoveActive="1"}),n.addEventListener("touchend",function(t){if(t.preventDefault(),t.stopPropagation(),n.dataset.touchMoveActive==="1"){n.dataset.touchMoveActive="0";return}u(t)})))}):r.warn("%cwidget does not have onFormSubmit handler defined",a);r.gather("#"+i.instanceId+" .shmktpl-has-active-state").forEach(function(n){n.classList.contains("shmktpl-submit")||(r.log("adding click event listener to %o",n),n.addEventListener("click",function(n){u(n)}),n.addEventListener("touchend",function(n){n.preventDefault();n.stopPropagation();u(n)}))});r.gather("#"+i.instanceId+" .digits-only").forEach(function(n){r.log("adding digitsOnly listener to %o",n);n.addEventListener("input",f)});n.setTimeout(function(){var n=i.root.querySelector("#"+i.instanceId+" .js-autofocus");n&&(r.log("auto focusing element %o",n),n.focus())},10);r.groupEnd()},s.setCheckedStateForRadioGroupInputAttribute=function(n,t){for(var u=this,r=u.root.querySelectorAll('[data-attribute-name="'+n+'"]'),i=0;i<r.length;i++)typeof r[i].dataset.checkedValue!="undefined"&&r[i].dataset.checkedValue.toLowerCase()===t.toLowerCase()?r[i].checked=!0:r[i].value.toLowerCase()===t.toLowerCase()&&(r[i].checked=!0)},s.getSelectedDropdownOption=function(n){for(var t,i=0,r=n.options.length;i<r;i++)if(t=n.options[i],t.selected)return t;return null},s.setSelectedDropdownValue=function(n,t){for(var i,r=0,u=n.options.length;r<u;r++)if(i=n.options[r],i.value.toLowerCase()===t.toLowerCase()){i.selected=!0;break}},s.setActiveStateForToggleInputAttribute=function(n,t){var f,r,i;if(typeof n!="undefined"&&typeof t!="undefined")for(f=this,r=f.root.querySelectorAll('[data-attribute-name="'+n+'"]'),u=0;u<r.length;u++)i=r[u],i.dataset.checkedValue.toLowerCase()===t.toLowerCase()?i.classList.add("active"):i.classList.remove("active")},s.updateMatchingDtoWithPublisherDefaults=function(n){var i=this,t=Object.keys(n);for(u=0;u<t.length;u++)i.matchingConfig.hasOwnProperty(t[u])?r.log("matchingConfig already has attribute %s, do not apply default value",t[u]):i.updateMatchingDtoAttributeValue(t[u],n[t[u]],!0)},s.setExtraClickParams=function(n){this.extraClickParams=n||{}},s.inFrame=function(){return n.self!==n.parent},s.domContainerWidth=function(){return this.root&&this.root.parentElement&&this.root.parentElement.clientWidth?this.root.parentElement.clientWidth:0},s.updateSearchStatus=function(n){var t=this,i;n=n||t.baseSearchStatusId;r.warn("currentWidget.currentSearchStatusId %s",t.currentSearchStatusId);r.warn("currentWidget.newSearchStatusId %s",n);t.currentSearchStatusId!==n&&(r.groupStart("currentWidget.updateSearchStatus"),t.hasOwnProperty("originalMatchingResult")&&t.originalMatchingResult.hasOwnProperty("listingset")&&(r.warn("updating search status to %s",n),i=gt,i=i+"?st="+n+"&si="+t.originalMatchingResult.listingset.searchid+"&sdt="+t.originalMatchingResult.listingset.sdt,r.jsonp(i,function(){t.currentSearchStatusId=n;t.initialSearchStatusId!==k||t.lightBoxCleared||(t.lightBoxCleared=!0)})),r.groupEnd())},s.loadComplete=function(){var n=this;at.indexOf(n.instanceId)<0?(at.push(n.instanceId),r.hasOwnProperty("disableWidgetLoadedEvent")&&r.disableWidgetLoadedEvent||(h("sh.widgetLoadComplete"),r.track("widget_load",{widget:n}))):r.warn("event already tracked!!!")},s.getAdditionalTrackingForPartnerProxyRequest=function(n){var t=this,i={widgetUserId:t.widgetUserId,js_session:t.sessionId,widgetId:t.widgetId,widgetConfigurationId:t.widgetconfigurationid,widgetInstanceId:t.instanceId,widgetContainerId:t.domContainer,widgetContainerWidth:t.domContainerWidth(),widgetDefaultSearchStatusId:t.listingLoadCount===0?t.initialSearchStatusId:v,originWidgetInstanceId:t.originwidgetinstanceid,widgetSearchCount:t.widgetSearchCount,widgetInventoryType:t.inventorytype};return t.hasOwnProperty("abTestVersion")?i.abTestVersion=t.abTestVersion:t.original_cfg&&t.original_cfg.abTestVersion&&(i.abTestVersion=t.original_cfg.abTestVersion),t.hasOwnProperty("algoWidgetId")&&(i.algoWidgetId=t.algoWidgetId),t.originalMatchingResult&&t.originalMatchingResult.listingset&&t.originalMatchingResult.listingset.rootsearchid?i.rootSearchId=t.originalMatchingResult.listingset.rootsearchid:t.matchingConfig&&t.matchingConfig.rootsearchid&&(i.rootSearchId=t.matchingConfig.rootsearchid),n?encodeURIComponent(JSON.stringify(i)):i},ut=f.push(s),r.log("widgetCreated = %o",s),r.groupEnd(),s}function ai(n){var i,u,t,e,f;if(r.groupStart("createMatchingDataFromConfig"),r.log("config passed to function: %o",n),i={},n.hasOwnProperty("data"))i=n.data,n.hasOwnProperty("abTestVersion")&&i.hasOwnProperty("tracking")&&(i.tracking.abTestVersion=n.abTestVersion);else for(u=Object.keys(n),t=0;t<u.length;t++)if(u[t]==="abTestVersion")for(e=Object.keys(n.abTestVersion),f=0;f<e.length;f++)i[e[f].toLowerCase()]=n.abTestVersion[e[f]];else typeof n[u[t]]!="object"&&typeof n[u[t]]!="undefined"&&n[u[t]]!==null&&(i[u[t].toLowerCase()]=n[u[t]]);return r.log("matchingData created: %o",i),r.groupEnd(),i}function it(n,t,i,u,f){var e=new XMLHttpRequest,o,s;e.open("POST",n,!0);o=u?"application/json; charset=UTF-8":"application/x-www-form-urlencoded; charset=UTF-8";e.setRequestHeader("Content-Type",o);vt&&(e.withCredentials=!0);f&&f.forEach(function(n){e.setRequestHeader(n.name,n.value)});s=u?JSON.stringify(t):t;typeof i=="function"&&(e.onreadystatechange=function(){var t,u;e.readyState===XMLHttpRequest.DONE&&(t=e.status,t===0||t>=200&&t<400?i(e.responseText):(u={data:{failedRequestEndpoint:n,statusCode:t}},r.track("http request failed",u),h("sh.listingApiRequestFailed",{})))});e.send(s)}function vi(n,t,i,u){r.groupStart("handleListingsResult");r.log("result = %o",t);typeof i=="function"&&(i(t),yi(n,t.response.listingset.widgetUserAttributes));u&&n.addRootCssClass("filtered");n.root.classList.remove("listingsLoading");n.addRootCssClass("listingsLoaded");h("sh.listingsLoaded",t);n.listingLoadCount+=1;r.groupEnd()}function yi(n,t){t&&t.widgetinstanceid?(n.responseWidgetUserAttributes=t,n.updateFormSelectionsWithAttributeValues(t),n.updateDynamicContent(n.options),n.updateDynamicContent(t)):n.updateDynamicContent(n.options)}function pi(){if(!t.hidden)for(u=0;u<f.length;u++)f[u].hasOwnProperty("currentSearchStatusId")&&f[u].currentSearchStatusId===yt&&f[u].updateSearchStatus(f[u].baseSearchStatusId)}var u,kt;if(!n.sh){var r={},o={},rt=0,ut=0,p=!1,dt=3,f=[],e="https://www.nextinsure.com",s="/ListingDisplay/",ft=e+s+"handlers/geo.ashx",gt=e+s+"handlers/su.ashx",et=e+s+"handlers/browserinfo.ashx",ot=e+s+"display/",st=e+s+"handlers/ev.ashx",ni=e+s+"handlers/imp_px.ashx",ht=e+s+"display/PhoneApi.aspx",ct=e+s+"loader/widget",lt=e+s+"listings",at=[],vt=!1,a="background-color:yellow; color:#000; font-weight:bold; padding:5px 0;",l=/localhost|test-nextinsure|nextinsure.test|nextinsure.quinstage/gi.test(e)||/shdebug/gi.test(n.location.href),ti=/qaTest/gi.test(n.location.href),ii=/shdebug/gi.test(n.location.href),v=1,yt=38,k=39;if(n.document.documentMode&&(l=!1),r.triggerEvent=function(n,t){var i=new Event(n);i.data=t;window.dispatchEvent(i)},r.gather=function(n,i){return i?[].slice.call(i.querySelectorAll(n)):[].slice.call(t.querySelectorAll(n))},r.log=function(){oi(arguments)},r.warn=function(){si(arguments)},r.consoleError=function(){hi(arguments)},r.groupStart=function(){l&&console.hasOwnProperty("group")&&typeof console.group=="function"&&console.group.apply(this,arguments)},r.groupEnd=function(){l&&console.hasOwnProperty("groupEnd")&&typeof console.groupEnd=="function"&&console.groupEnd()},r.loadFont=function(n){if(!Array.isArray(n)||n.length===0){r.warn("no fonts to load");return}(r.groupStart("sh.loadFont"),r.log("fonts = %o",n),p)||(typeof ShWebFont=="object"&&(p=!0,ShWebFont.load({google:{families:n},active:function(){p=!1},inactive:function(){p=!1}})),r.groupEnd())},r.displayErrors=function(n){r.warn("form errors: %o",n);n.forEach(function(n){n.classList.add("error");n.tagName==="SELECT"?n.addEventListener("change",function t(){n.classList.remove("error");n.removeEventListener("change",t)}):n.addEventListener("input",function t(){n.classList.remove("error");n.removeEventListener("input",t)})});n.length>0&&n[0].focus()},r.showPage=function(n,t){var i=r.getCurrentWidget(n),u=t>0?"next":t<0?"prev":"first";i.showPage(u)},r.updateSearchStatus=function(n,t){var i=r.getCurrentWidget(n);i.updateSearchStatus(t)},r.getCurrentWidget=function(n){r.groupStart("getCurrentWidget for instanceId %s",n);for(var i=0;i<f.length;i++)if(f[i].instanceId===n)return f[i].root||(r.log("setting widget root"),f[i].root=t.querySelector("#"+n)),r.log("current widget instance %s %o",n,f[i]),r.groupEnd(),f[i];return r.groupEnd(),{}},r.track=function(n,t){var e,s;if(!c(n)){r.groupStart("sh.track");var i=t||{},f={},o=undefined;if(i.hasOwnProperty("widget")&&typeof i.widget=="object"&&!c(i.widget)?(o=i.widget.src,f={TransactionId:i.widget.getMatchingDtoAttributeValue("trn_id"),WidgetInstanceId:i.widget.instanceId,OriginWidgetInstanceId:i.widget.originwidgetinstanceid,DomContainer:i.widget.domContainer,WidgetId:i.widget.widgetId,ListingStyleId:i.widget.widgetId+1e3,DomContainerWidth:i.widget.domContainerWidth(),InventoryType:i.widget.inventorytype,var1:i.widget.getMatchingDtoAttributeValue("var1"),var2:i.widget.getMatchingDtoAttributeValue("var2"),var3:i.widget.getMatchingDtoAttributeValue("var3"),QuadUrl:i.widget.getMatchingDtoAttributeValue("quad_url"),ExtClickId:i.widget.getMatchingDtoAttributeValue("ext_click_id")},i.widget.hasOwnProperty("abTestVersion")&&(f.WidgetAbTestWidgetId=i.widget.abTestVersion.widgetAbTestWidgetId,f.WidgetAbTestId=i.widget.abTestVersion.widgetAbTestId,f.WidgetAbTestFrequency=i.widget.abTestVersion.frequency,f.WidgetAbTestVersionFlag=i.widget.abTestVersion.flag),n==="widget_load"&&(f.EventId=i.widget.widgetLoadEventId)):i.hasOwnProperty("src")&&typeof i.src!="undefined"&&(o=i.src),i.hasOwnProperty("data")&&typeof i.data=="object")for(e=Object.keys(i.data),u=0;u<e.length;u++)r.log("Adding extra property to event Info %s = %s",e[u],i.data[e[u]]),f[e[u]]=i.data[e[u]];n==="user_visit"&&i.hasOwnProperty("sessionWidgetInstanceId")&&!c(i.sessionWidgetInstanceId)&&(f.WidgetInstanceId=i.sessionWidgetInstanceId);s={event_name:n,session_id:r.currentSessionId,widgetUserId:r.currentWidgetUserId,ref:r.currentPageUrl,frm:r.currentPageReferrer,event_data:b(f)};typeof o!="undefined"&&(s.source_id=o);r.warn("event = %o",s);it(st,s,null,!0);r.groupEnd()}},r.error=function(n){try{typeof r.errorCallback=="function"&&r.errorCallback(n);console.error(n)}catch(t){console.error(t);return}console.log(n);r.track("js_error",{data:{errObj:n}})},r.enableDirectLinks=function(){var n=r.gather(".shmktpl-direct-link");n.forEach(function(n){n.removeEventListener("click",pt)});n.forEach(function(n){n.addEventListener("click",pt)})},r.getWidgetFromServer=function(n){var i,u,f,e;r.groupStart("sh.getWidgetFromServer");i={src:n.src,idx:n.idx};typeof n.inventorytype!="undefined"&&(i.it=n.inventorytype);typeof n.widgetType!="undefined"&&(i.widgetType=n.widgetType);typeof n.widgetId!="undefined"&&(i.widgetId=n.widgetId);typeof n.widgetFile!="undefined"&&(i.widgetFile=n.widgetFile);typeof n.abTestVersion=="object"&&(i.widgetAbTestWidgetId=n.abTestVersion.widgetAbTestWidgetId,i.widgetId=n.abTestVersion.widgetId,typeof n.abTestVersion.algoWidgetId!="undefined"&&(i.algoWidgetId=n.abTestVersion.algoWidgetId));typeof n.widget!="undefined"&&(i.widget=n.widget);r.log("widgetToLoad %o",n);u=ct+nt(i);r.log("widget request: %s",u);f=t.scripts[0];e=t.createElement("script");e.src=u;f.parentNode.insertBefore(e,f);r.groupEnd()},r.processServerWidgetResponse=function(i,u){function tt(n){function y(n){for(var i,r,t=n.length-1;t>0;t--)i=Math.floor(Math.random()*(t+1)),r=n[t],n[t]=n[i],n[i]=r}var p=n[0].widgetAbTestId,t="shmktpl:widgetAbTest:"+p,f,o,c,i,e,s,a,h,v,u;try{if(!ii&&sessionStorage.getItem(t)&&(f=!1,o=JSON.parse(sessionStorage.getItem(t)),o.hasOwnProperty("expires")?(c=Number(o.expires),f=Date.now()>c):f=!0,!f))return r.warn("returning sticky ab test for %s",t),JSON.parse(sessionStorage.getItem(t))}catch(l){r.warn("error accessing sessionStorage: %o",l)}for(i=[],e=0;e<n.length;e++)for(s=n[e],a=s.frequency,h=0;h<a;h++)i.push(s);y(i);v=Math.floor(Math.random()*i.length);u=i[v];u.expires=Date.now()+864e5;r.log("selected test version= %o",u);try{sessionStorage.setItem(t,JSON.stringify(u))}catch(l){r.warn("error accessing sessionStorage: %o",l)}return u}function it(n){function i(n){var f=u[n];if(f){var s=f.text||f.textContent||f.innerHTML||"",e=t.getElementsByTagName("head")[0]||t.documentElement,r=t.createElement("script"),o=f.getAttribute("src");if(o)r.setAttribute("src",o),r.onload=function(){i(n+1)};else{r.setAttribute("type","text/javascript");try{r.appendChild(t.createTextNode(s))}catch(h){r.text=s}}e.insertBefore(r,e.firstChild);e.removeChild(r);o||i(n+1)}}for(var u=[],f=n.getElementsByTagName("script"),r=0;r<f.length;r++)u.push(f[r]);i(0)}var e,l,g,k,o,d,y,a,p,w,h,b,nt,s;for(r.groupStart("sh.processServerWidgetResponse"),r.log("widgetResponse %o",i),e={},l=0;l<f.length;l++)if(f[l].idx===u){e=f[l];break}if(Array.isArray(i.test_versions)&&i.test_versions.length>0){r.log("Current AB Tests: %o",i.test_versions);g=tt(i.test_versions);k=e.original_cfg;k.abTestVersion=g;r.initialize(k,e.domContainer);return}try{if(e.widgetId=i.widgetId,e.currentPage=1,e.inventorytype=i.inventorytype,e.baseinventorytype=i.baseinventorytype,e.widgetconfigurationid=i.widgetconfigurationid,e.blocks=i.blocks||[],e.pagingConfig=i.pagingConfig||{},e.hiddenInputs=i.hiddeninputs||{},e.initialSearchStatusId=i.initialsearchstatus||v,vt=i.addwithcredentialsheader||!1,o=JSON.parse(i.defaultOptions),r.groupStart("handling widget default options"),r.log("defaultWidgetOptions returned from server %o",o),o)for(d=Object.keys(o),y=0;y<d.length;y++)if(a=d[y],a==="defaultUserAttributes"&&e.options.hasOwnProperty("defaultUserAttributes")){if(p=Object.keys(o.defaultUserAttributes),p)for(w=0;w<p.length;w++)h=p[w],e.options.defaultUserAttributes.hasOwnProperty(h)||(r.log("updating defaultUserAttribute %s to %s",h,o.defaultUserAttributes[h]),e.options.defaultUserAttributes[h]=o.defaultUserAttributes[h])}else e.options.hasOwnProperty(a)||(e.options[a]=o[a]);r.log("final widget options %o",e.options);r.groupEnd();b=t.getElementById(e.domContainer);b&&(nt=i.markup.replace(/randomId/gi,e.instanceId),b.innerHTML=nt,s=t.getElementById(e.instanceId),s&&(c(i.widgetcategory)||(s.classList.add(i.widgetcategory),s.dataset.category=i.widgetcategory,e.widgetCategory=i.widgetcategory),c(i.widgetcategorytype)||(s.classList.add(i.widgetcategorytype),s.dataset.categorytype=i.widgetcategorytype,e.widgetCategoryType=i.widgetcategorytype),e.deviceClass=typeof i.searchtype!="undefined"?i.searchtype===1?"desktop":"mobile":n.outerWidth<600?"mobile":"desktop",typeof i.algoWidgetId!="undefined"&&(e.algoWidgetId=i.algoWidgetId),s.dataset.widgetId=e.widgetId),it(b));e.loadComplete()}catch(rt){r.error(rt)}r.groupEnd()},r.loadListingsForWidget=function(n,t,i){r.groupStart("calling matching for widget instance %s, isFormSubmission = %s",n.instanceId,i);n.addRootCssClass("listingsLoading");n.finalizeMatchingConfig();i&&n.updateMatchingDtoWithFormSelections();var f=null,u=n.matchingConfig.hasOwnProperty("tracking"),e=u?lt:ot,o=u?n.matchingConfig:nt(n.matchingConfig).substr(1);n.apiEndPoint&&(u=!0,e=n.apiEndPoint,o=n.matchingConfig,n.requestHeaders&&(f=n.requestHeaders));r.log("%cmatching data = %o",a,n.matchingConfig);it(e,o,function(r){var u=JSON.parse(r);vi(n,u,t,i)},u,f);r.groupEnd()},r.jsonp=function(i,u){r.groupStart("sh.jsonp");r.log("endpoint = %s",i);var f="sh_jsonp_cb_"+rt,o=t.scripts[0],e=t.createElement("script");e.src=i+(~i.indexOf("?")?"&":"?")+"cb="+f;o.parentNode.insertBefore(e,o);n[f]=function(t){e.parentNode.removeChild(e);u(t);n[f]=undefined;try{delete n[f]}catch(i){return}};rt+=1;r.groupEnd()},r.loadGeo=function(n,t){r.groupStart("sh.loadGeo");var i=ft;typeof t=="string"&&(i=i+"?zc="+t);r.jsonp(i,function(t){typeof n=="function"&&n(t);h("sh.geoLoaded",t)});r.groupEnd()},r.validateZip=function(n,t){r.loadGeo(function(n){t(n&&!n.geotargeted)},n)},r.loadBrowserInfo=function(n){r.groupStart("sh.loadBrowserInfo");r.jsonp(et,function(t){typeof n=="function"&&n(t);h("sh.browserInfoLoaded",t)});r.groupEnd()},r.click=function(t,i,u){var f,e,o;if(u=u||{},f={adPosition:t,clickUrl:i,data:u},f.data.hasOwnProperty("evt")&&typeof f.data.evt!="undefined"&&typeof f.data.evt.preventDefault=="function"&&(r.log("stopping propogation of click event..."),f.data.evt.preventDefault(),f.data.evt.stopPropagation()),r.log("click occurred: %o",f),h("sh.clickOccurred",f),e=navigator.userAgent||navigator.vendor||n.opera,o=u.hasOwnProperty("openInSameWindow")&&u.openInSameWindow,/\[FB(AN|_IAB).*FBAV\/(\d+)/.test(e)||o){n.location.href=i;return}n.open(i)||(n.location.href=i)},r.trackUserVisit=function(n){var t=n||{},i=ui(!0);t.sessionWidgetInstanceId=i;r.log(t);r.track("user_visit",t)},r.clicktocall=function(i,u,f){h("sh.clicktocallRequest",{adPosition:i});var e=ht+"?"+u;r.jsonp(e,function(i){i!==null&&typeof i=="object"&&(i.launchCall?n.location="tel:1"+i.ccPhoneNum:(t.getElementById("ctc-button-"+f).style.display="none",t.getElementById("ctc-result-"+f).style.display="block",t.getElementById("ctc-result-number-"+f).innerHTML=i.formattedNumber))})},r.listen=function(n,t){typeof o[n]=="undefined"&&(o[n]=[]);o[n].push(t)},r.unlisten=function(n,t){if(o[n])for(var i=0;i<o[n].length;i++)if(o[n][i]===t){o[n].splice(i,1);break}},r.initialize=function(n,i){var u,f;r.groupStart("sh.initialize");c(i)&&(i=bt(),r.warn("created default container %s",i));typeof i!="undefined"&&(r.log("initializing with widgetConfiguration = %o, domContainer = %s",n,i),t.querySelector("#"+i)?(u=w(n),delete u.abTestVersion,!n.hasOwnProperty("src")&&n.hasOwnProperty("ni_ad_client")&&(n.src=n.ni_ad_client,delete n.ni_ad_client),n.hasOwnProperty("data")&&n.data.hasOwnProperty("tracking")&&typeof n.data.tracking.ni_ad_client!="undefined"&&(n.src=n.data.tracking.ni_ad_client),!n.hasOwnProperty("widgetId")&&n.hasOwnProperty("widgetid")&&(n.widgetId=n.widgetid,delete n.widgetid),f=tt(n,i),f.original_cfg=u,r.getWidgetFromServer(f)):r.warn("domContainer "+i+" does not exist!!!!"),r.groupEnd())},r.initializeWithCustomWidget=function(n,i){if(n.hasOwnProperty("widgetMarkupTagId")&&(r.groupStart("sh.initializeWithCustomWidget"),(typeof i=="undefined"||i===""||i===null)&&(i=bt()),typeof i!="undefined")){var u=w(n),f=tt(n,i);f.original_cfg=u;r.loadBrowserInfo(function(i){r.processServerWidgetResponse({markup:t.getElementById(n.widgetMarkupTagId).innerHTML,widgetId:"99999",widgetcategory:n.widgetcategory||"",widgetcategorytype:n.widgetcategorytype||"",searchtype:i.searchTypeId,defaultOptions:n.defaultOptions||"{}"},0)});r.groupEnd()}},r.formatMoney=function(n,t){if(typeof Intl.NumberFormat=="undefined")return n.toString();var i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:t});return i.format(n)},r.fadeInElement=function(n,t){n.style.opacity=0;var i=0,r=setInterval(function(){i<1?(i=i+.05,n.style.opacity=i):(clearInterval(r),typeof t=="function"&&t())},10)},r.detachElement=function(n){return n.parentElement.removeChild(n)},r.addEvent=function(n,t,i){n.addEventListener(t,i)},r.optOutOfSingleBuyerRedirect=function(n,t){t.stopPropagation();t.preventDefault();ei("singleBuyerRedirectDisabled","1");r.reloadWidget(n)},r.reloadWidget=function(n){var i=r.getCurrentWidget(n),t=w(i.original_cfg);t.hasOwnProperty("data")&&t.data.hasOwnProperty("tracking")?(delete t.data.tracking.single_buyer_redirect,delete t.data.tracking.buyer,t.data.tracking.osc="91"):(delete t.single_buyer_redirect,delete t.buyer,t.osc="91");r.initialize(t,i.domContainer)},r.debug=function(){function t(n,t){return n+" = "+t+"\r\n"}var i=t("host",e);i+=t("appPath",s);i+=t("geoEndpoint",ft);i+=t("browserInfoEndpoint",et);i+=t("listingsEndpoint",ot);i+=t("eventLogEndpoint",st);i+=t("clickToCallEndpoint",ht);i+=t("widgetEndpoint",ct);i+=t("listingsPostEndpoint",lt);console.log("%c%s","line-height:2em;",i);for(n in f)console.log("%cwidget instance %s, %o","font-weight:bold; color:blue",f[n].instanceId,f[n])},r.currentWidgets=function(){return f},r.listen("sh.clickOccurred",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:"shclick"})}),t.addEventListener("visibilitychange",pi),r.currentHost=e,r.currentSessionId=ri(),r.currentWidgetUserId=fi(),r.currentPageUrl=n.location.href,r.currentPageReferrer=t.referrer,n.sh=r,typeof n.sh_ready=="function")n.sh_ready();else if(typeof n.sh_ready=="object"&&Array.isArray(n.sh_ready))for(u=0;u<n.sh_ready.length;u++)kt=n.sh_ready[u],kt()}})(this,this.document,shNunjucks);
typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n){"use strict";var u,i,t,r;if(n===null)throw new TypeError("Cannot convert undefined or null to object");for(u=Object(n),i=1;i<arguments.length;i++)if(t=arguments[i],t!==null)for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(u[r]=t[r]);return u},writable:!0,configurable:!0});
